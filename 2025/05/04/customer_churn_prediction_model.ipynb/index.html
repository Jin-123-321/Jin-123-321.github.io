<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Customer Churn Prediction Model | Hexo</title><meta name="author" content="Jin"><meta name="copyright" content="Jin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Telco Customer Churn Prediction1. é¡¹ç›®ä»‹ç» &amp; ç›®æ ‡è¯´æ˜â€œPredict behavior to retain customers. You can analyze all relevant customer data and develop focused customer retention programs.â€ [IBM Sample Data Se">
<meta property="og:type" content="article">
<meta property="og:title" content="Customer Churn Prediction Model">
<meta property="og:url" content="http://example.com/2025/05/04/customer_churn_prediction_model.ipynb/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Telco Customer Churn Prediction1. é¡¹ç›®ä»‹ç» &amp; ç›®æ ‡è¯´æ˜â€œPredict behavior to retain customers. You can analyze all relevant customer data and develop focused customer retention programs.â€ [IBM Sample Data Se">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/avatar.png">
<meta property="article:published_time" content="2025-05-04T13:00:00.000Z">
<meta property="article:modified_time" content="2025-05-04T07:46:10.241Z">
<meta property="article:author" content="Jin">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="æ•°æ®åˆ†æ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/avatar.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Customer Churn Prediction Model",
  "url": "http://example.com/2025/05/04/customer_churn_prediction_model.ipynb/",
  "image": "http://example.com/img/avatar.png",
  "datePublished": "2025-05-04T13:00:00.000Z",
  "dateModified": "2025-05-04T07:46:10.241Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jin",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/05/04/customer_churn_prediction_model.ipynb/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Customer Churn Prediction Model',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Hexo</span></a><a class="nav-page-title" href="/"><span class="site-name">Customer Churn Prediction Model</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Customer Churn Prediction Model</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-05-04T13:00:00.000Z" title="Created 2025-05-04 21:00:00">2025-05-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-05-04T07:46:10.241Z" title="Updated 2025-05-04 15:46:10">2025-05-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Telco-Customer-Churn-Prediction"><a href="#Telco-Customer-Churn-Prediction" class="headerlink" title="Telco Customer Churn Prediction"></a>Telco Customer Churn Prediction</h1><h2 id="1-é¡¹ç›®ä»‹ç»-ç›®æ ‡è¯´æ˜"><a href="#1-é¡¹ç›®ä»‹ç»-ç›®æ ‡è¯´æ˜" class="headerlink" title="1. é¡¹ç›®ä»‹ç» &amp; ç›®æ ‡è¯´æ˜"></a>1. é¡¹ç›®ä»‹ç» &amp; ç›®æ ‡è¯´æ˜</h2><p>â€œPredict behavior to retain customers. You can analyze all relevant customer data and develop focused customer retention programs.â€ [IBM Sample Data Sets]</p>
<p><a target="_blank" rel="noopener" href="https://www.kaggle.com/datasets/blastchar/telco-customer-churn?resource=download">https://www.kaggle.com/datasets/blastchar/telco-customer-churn?resource=download</a></p>
<h2 id="2-å¯¼å…¥åº“-åŠ è½½æ•°æ®"><a href="#2-å¯¼å…¥åº“-åŠ è½½æ•°æ®" class="headerlink" title="2. å¯¼å…¥åº“ &amp; åŠ è½½æ•°æ®"></a>2. å¯¼å…¥åº“ &amp; åŠ è½½æ•°æ®</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.filterwarnings(<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å¯¼å…¥åº“ &amp; åŠ è½½æ•°æ®</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder, StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, confusion_matrix, roc_auc_score</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å›¾è¡¨ä¸­æ–‡æ˜¾ç¤º</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]      <span class="comment"># æ”¯æŒä¸­æ–‡å­—ä½“</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span>    <span class="comment"># æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span></span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;whitegrid&quot;</span>)                    <span class="comment"># ç»Ÿä¸€é£æ ¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ•°æ®</span></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;telco_churn.csv&quot;</span>)</span><br><span class="line">df.head()</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>gender</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>tenure</th>
      <th>PhoneService</th>
      <th>MultipleLines</th>
      <th>InternetService</th>
      <th>OnlineSecurity</th>
      <th>...</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>Contract</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>Female</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
      <td>1</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>No</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>29.85</td>
      <td>29.85</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>34</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Mailed check</td>
      <td>56.95</td>
      <td>1889.5</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Mailed check</td>
      <td>53.85</td>
      <td>108.15</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>45</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Bank transfer (automatic)</td>
      <td>42.30</td>
      <td>1840.75</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>Female</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>Fiber optic</td>
      <td>No</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>70.70</td>
      <td>151.65</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 21 columns</p>
</div>



<h3 id="2-1-æŸ¥çœ‹æ•°æ®ç»“æ„å’Œæ•°æ®ç±»å‹"><a href="#2-1-æŸ¥çœ‹æ•°æ®ç»“æ„å’Œæ•°æ®ç±»å‹" class="headerlink" title="2.1. æŸ¥çœ‹æ•°æ®ç»“æ„å’Œæ•°æ®ç±»å‹"></a>2.1. æŸ¥çœ‹æ•°æ®ç»“æ„å’Œæ•°æ®ç±»å‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ•°æ®åŸºæœ¬ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Œ Data dimensions (rows, columns)ï¼š&quot;</span>, df.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Œ Data types and non-null numbers:&quot;</span>)</span><br><span class="line">display(df.info())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰å­—æ®µçš„å”¯ä¸€å€¼æ•°é‡ï¼ˆè¯†åˆ«ç±»åˆ«å˜é‡ vs æ•°å€¼å˜é‡ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Œ Number of unique values â€‹â€‹per column:&quot;</span>)</span><br><span class="line">display(df.nunique())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥ç¼ºå¤±å€¼</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Œ Missing value statistics:&quot;</span>)</span><br><span class="line">display(df.isnull().<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„è§ˆå‰å‡ è¡Œ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nğŸ“Œ Preview of the first five rows of data:&quot;</span>)</span><br><span class="line">display(df.head())</span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Œ Data dimensions (rows, columns)ï¼š (7043, 21)

ğŸ“Œ Data types and non-null numbers:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7043 entries, 0 to 7042
Data columns (total 21 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   customerID        7043 non-null   object 
 1   gender            7043 non-null   object 
 2   SeniorCitizen     7043 non-null   int64  
 3   Partner           7043 non-null   object 
 4   Dependents        7043 non-null   object 
 5   tenure            7043 non-null   int64  
 6   PhoneService      7043 non-null   object 
 7   MultipleLines     7043 non-null   object 
 8   InternetService   7043 non-null   object 
 9   OnlineSecurity    7043 non-null   object 
 10  OnlineBackup      7043 non-null   object 
 11  DeviceProtection  7043 non-null   object 
 12  TechSupport       7043 non-null   object 
 13  StreamingTV       7043 non-null   object 
 14  StreamingMovies   7043 non-null   object 
 15  Contract          7043 non-null   object 
 16  PaperlessBilling  7043 non-null   object 
 17  PaymentMethod     7043 non-null   object 
 18  MonthlyCharges    7043 non-null   float64
 19  TotalCharges      7043 non-null   object 
 20  Churn             7043 non-null   object 
dtypes: float64(1), int64(2), object(18)
memory usage: 1.1+ MB



None
</code></pre>
<p>â€‹<br>    ğŸ“Œ Number of unique values â€‹â€‹per column:</p>
<pre><code>customerID          7043
gender                 2
SeniorCitizen          2
Partner                2
Dependents             2
tenure                73
PhoneService           2
MultipleLines          3
InternetService        3
OnlineSecurity         3
OnlineBackup           3
DeviceProtection       3
TechSupport            3
StreamingTV            3
StreamingMovies        3
Contract               3
PaperlessBilling       2
PaymentMethod          4
MonthlyCharges      1585
TotalCharges        6531
Churn                  2
dtype: int64
</code></pre>
<p>â€‹<br>    ğŸ“Œ Missing value statistics:</p>
<pre><code>customerID          0
gender              0
SeniorCitizen       0
Partner             0
Dependents          0
tenure              0
PhoneService        0
MultipleLines       0
InternetService     0
OnlineSecurity      0
OnlineBackup        0
DeviceProtection    0
TechSupport         0
StreamingTV         0
StreamingMovies     0
Contract            0
PaperlessBilling    0
PaymentMethod       0
MonthlyCharges      0
TotalCharges        0
Churn               0
dtype: int64
</code></pre>
<p>â€‹<br>    ğŸ“Œ Preview of the first five rows of data:</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>customerID</th>
      <th>gender</th>
      <th>SeniorCitizen</th>
      <th>Partner</th>
      <th>Dependents</th>
      <th>tenure</th>
      <th>PhoneService</th>
      <th>MultipleLines</th>
      <th>InternetService</th>
      <th>OnlineSecurity</th>
      <th>...</th>
      <th>DeviceProtection</th>
      <th>TechSupport</th>
      <th>StreamingTV</th>
      <th>StreamingMovies</th>
      <th>Contract</th>
      <th>PaperlessBilling</th>
      <th>PaymentMethod</th>
      <th>MonthlyCharges</th>
      <th>TotalCharges</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7590-VHVEG</td>
      <td>Female</td>
      <td>0</td>
      <td>Yes</td>
      <td>No</td>
      <td>1</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>No</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>29.85</td>
      <td>29.85</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5575-GNVDE</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>34</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Mailed check</td>
      <td>56.95</td>
      <td>1889.5</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3668-QPYBK</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Mailed check</td>
      <td>53.85</td>
      <td>108.15</td>
      <td>Yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7795-CFOCW</td>
      <td>Male</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>45</td>
      <td>No</td>
      <td>No phone service</td>
      <td>DSL</td>
      <td>Yes</td>
      <td>...</td>
      <td>Yes</td>
      <td>Yes</td>
      <td>No</td>
      <td>No</td>
      <td>One year</td>
      <td>No</td>
      <td>Bank transfer (automatic)</td>
      <td>42.30</td>
      <td>1840.75</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9237-HQITU</td>
      <td>Female</td>
      <td>0</td>
      <td>No</td>
      <td>No</td>
      <td>2</td>
      <td>Yes</td>
      <td>No</td>
      <td>Fiber optic</td>
      <td>No</td>
      <td>...</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>No</td>
      <td>Month-to-month</td>
      <td>Yes</td>
      <td>Electronic check</td>
      <td>70.70</td>
      <td>151.65</td>
      <td>Yes</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 21 columns</p>
</div>


<h4 id="ğŸ§¼-æ•°æ®æ¸…æ´—é‡ç‚¹æ€»ç»“"><a href="#ğŸ§¼-æ•°æ®æ¸…æ´—é‡ç‚¹æ€»ç»“" class="headerlink" title="ğŸ§¼ æ•°æ®æ¸…æ´—é‡ç‚¹æ€»ç»“"></a>ğŸ§¼ æ•°æ®æ¸…æ´—é‡ç‚¹æ€»ç»“</h4><p>æ ¹æ®æ•°æ®åŠ è½½ä¸æè¿°æ€§ç»Ÿè®¡ç»“æœï¼Œå½“å‰æ•°æ®å­˜åœ¨ä»¥ä¸‹éœ€è¦æ¸…æ´—çš„å…³é”®ç‚¹ï¼š</p>
<table>
<thead>
<tr>
<th>å­—æ®µå</th>
<th>é—®é¢˜æè¿°</th>
<th>å»ºè®®å¤„ç†æ–¹å¼</th>
</tr>
</thead>
<tbody><tr>
<td><code>customerID</code></td>
<td>æ ‡è¯†ç¬¦</td>
<td>åˆ </td>
</tr>
<tr>
<td><code>TotalCharges</code></td>
<td>è¢«è¯†åˆ«ä¸º object ç±»å‹ï¼Œå®ä¸ºæ•°å€¼å‹</td>
<td>è½¬æ¢ä¸º floatï¼Œå¹¶å¤„ç†ç¼ºå¤±å€¼</td>
</tr>
<tr>
<td>å¤šä¸ªæœåŠ¡å­—æ®µï¼ˆå¦‚ <code>OnlineSecurity</code>, <code>StreamingTV</code>, <code>MultipleLines</code> ç­‰ï¼‰</td>
<td>éƒ¨åˆ†ç±»åˆ«å€¼ä¸º <code>&quot;No internet service&quot;</code> æˆ– <code>&quot;No phone service&quot;</code>ï¼Œå®é™…ä¸Šç­‰åŒäº <code>&quot;No&quot;</code></td>
<td>å°†è¿™äº›ç‰¹æ®Šç±»åˆ«ç»Ÿä¸€å½’ä¸º <code>&quot;No&quot;</code></td>
</tr>
<tr>
<td><code>SeniorCitizen</code></td>
<td>æ•°æ®ç±»å‹ä¸º int64ï¼ˆ0&#x2F;1ï¼‰ï¼Œæœ¬è´¨ä¸Šæ˜¯ç±»åˆ«å˜é‡</td>
<td>ä¿ç•™ or è½¬æ¢ä¸ºå­—ç¬¦ä¸²ç±»åˆ«å†è¿›è¡Œç¼–ç </td>
</tr>
<tr>
<td><code>Churn</code></td>
<td>ç›®æ ‡å˜é‡ä¸º â€œYesâ€&#x2F;â€œNoâ€ï¼Œä¸º object ç±»å‹</td>
<td>æ˜ å°„ä¸ºäºŒå…ƒæ•°å€¼å˜é‡</td>
</tr>
<tr>
<td>å…¶ä»–ç±»åˆ«å˜é‡ï¼ˆå¦‚ <code>gender</code>, <code>Contract</code>, <code>PaymentMethod</code> ç­‰ï¼‰</td>
<td>ä¸º object ç±»å‹ï¼Œéœ€è¿›è¡Œç¼–ç å¤„ç†</td>
<td>LabelEncoder æˆ– OneHotEncoder</td>
</tr>
</tbody></table>
<hr>
<h5 id="âœ…-æ¸…æ´—å®Œæˆåçš„ç›®æ ‡ï¼š"><a href="#âœ…-æ¸…æ´—å®Œæˆåçš„ç›®æ ‡ï¼š" class="headerlink" title="âœ… æ¸…æ´—å®Œæˆåçš„ç›®æ ‡ï¼š"></a>âœ… æ¸…æ´—å®Œæˆåçš„ç›®æ ‡ï¼š</h5><ul>
<li>æ‰€æœ‰ç‰¹å¾æ•°æ®ç±»å‹æ˜ç¡®ï¼ˆæ•°å€¼å‹ or ç¼–ç åçš„ç±»åˆ«å‹ï¼‰</li>
<li>æ— ç¼ºå¤±å€¼æˆ–å·²å¦¥å–„å¡«è¡¥&#x2F;åˆ é™¤</li>
<li>ç›®æ ‡å˜é‡ <code>Churn</code> ä¸º 0&#x2F;1 æ•°å€¼å‹</li>
<li>åˆ é™¤æ— ç”¨å­—æ®µï¼ˆå¦‚ <code>customerID</code>ï¼‰</li>
</ul>
<h2 id="3-æ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†"><a href="#3-æ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†" class="headerlink" title="3. æ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†"></a>3. æ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†</h2><h3 id="3-1-ç¼ºå¤±å€¼å¤„ç†"><a href="#3-1-ç¼ºå¤±å€¼å¤„ç†" class="headerlink" title="3.1 ç¼ºå¤±å€¼å¤„ç†"></a>3.1 ç¼ºå¤±å€¼å¤„ç†</h3><p>åœ¨æœ¬æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å¤„ç† <code>TotalCharges</code> å­—æ®µä¸­çš„å¼‚å¸¸å€¼ï¼ˆç©ºå­—ç¬¦ä¸²å¯¼è‡´çš„è½¬æ¢å¤±è´¥ï¼‰ï¼Œå¹¶åˆ é™¤æ— æ³•è½¬æ¢ä¸ºæ•°å€¼çš„ 11 æ¡è®°å½•ã€‚</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°† TotalCharges ä» object è½¬ä¸º floatï¼Œé”™è¯¯çš„è®¾ä¸º NaN</span></span><br><span class="line">df[<span class="string">&#x27;TotalCharges&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;TotalCharges&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è½¬æ¢å¤±è´¥æ•°é‡ï¼ˆå³ NaNï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;â— TotalCharges Number of conversion failures (NaN):&quot;</span>, df[<span class="string">&#x27;TotalCharges&#x27;</span>].isnull().<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤åŒ…å« NaN çš„è®°å½•ï¼ˆå…± 11 æ¡ï¼‰</span></span><br><span class="line">df.dropna(subset=[<span class="string">&#x27;TotalCharges&#x27;</span>], inplace=<span class="literal">True</span>)</span><br><span class="line">df.reset_index(drop=<span class="literal">True</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼ºå¤±å€¼å¤„ç†åæŸ¥çœ‹æ€»è§ˆ</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;âœ… The data structure after missing value processing is completed:&quot;</span>)</span><br><span class="line">display(df.info())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>â— TotalCharges Number of conversion failures (NaN): 11
âœ… The data structure after missing value processing is completed:
&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7032 entries, 0 to 7031
Data columns (total 21 columns):
 #   Column            Non-Null Count  Dtype  
---  ------            --------------  -----  
 0   customerID        7032 non-null   object 
 1   gender            7032 non-null   object 
 2   SeniorCitizen     7032 non-null   int64  
 3   Partner           7032 non-null   object 
 4   Dependents        7032 non-null   object 
 5   tenure            7032 non-null   int64  
 6   PhoneService      7032 non-null   object 
 7   MultipleLines     7032 non-null   object 
 8   InternetService   7032 non-null   object 
 9   OnlineSecurity    7032 non-null   object 
 10  OnlineBackup      7032 non-null   object 
 11  DeviceProtection  7032 non-null   object 
 12  TechSupport       7032 non-null   object 
 13  StreamingTV       7032 non-null   object 
 14  StreamingMovies   7032 non-null   object 
 15  Contract          7032 non-null   object 
 16  PaperlessBilling  7032 non-null   object 
 17  PaymentMethod     7032 non-null   object 
 18  MonthlyCharges    7032 non-null   float64
 19  TotalCharges      7032 non-null   float64
 20  Churn             7032 non-null   object 
dtypes: float64(2), int64(2), object(17)
memory usage: 1.1+ MB



None
</code></pre>
<h3 id="3-2-ç‰¹å¾ç¼–ç "><a href="#3-2-ç‰¹å¾ç¼–ç " class="headerlink" title="3.2 ç‰¹å¾ç¼–ç "></a>3.2 ç‰¹å¾ç¼–ç </h3><p>æˆ‘ä»¬å°†ä»¥ä¸‹å­—æ®µä¸­çš„ç±»åˆ«å€¼ <code>&quot;No internet service&quot;</code> &#x2F; <code>&quot;No phone service&quot;</code> ç»Ÿä¸€æ›¿æ¢ä¸º <code>&quot;No&quot;</code>ï¼Œå¹¶ä½¿ç”¨ LabelEncoder å¯¹æ‰€æœ‰ç±»åˆ«å‹å˜é‡è¿›è¡Œç¼–ç ã€‚</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›¿æ¢ &quot;No internet service&quot; / &quot;No phone service&quot; ä¸º &quot;No&quot;</span></span><br><span class="line">replace_cols = [<span class="string">&#x27;MultipleLines&#x27;</span>, <span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;OnlineBackup&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;DeviceProtection&#x27;</span>, <span class="string">&#x27;TechSupport&#x27;</span>, <span class="string">&#x27;StreamingTV&#x27;</span>, <span class="string">&#x27;StreamingMovies&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> replace_cols:</span><br><span class="line">    df[col] = df[col].replace(&#123;<span class="string">&#x27;No internet service&#x27;</span>: <span class="string">&#x27;No&#x27;</span>, <span class="string">&#x27;No phone service&#x27;</span>: <span class="string">&#x27;No&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ç›®æ ‡å˜é‡ Churn æ˜ å°„ä¸ºæ•°å€¼å‹</span></span><br><span class="line">df[<span class="string">&#x27;Churn&#x27;</span>] = df[<span class="string">&#x27;Churn&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;No&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;Yes&#x27;</span>: <span class="number">1</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹æ‰€æœ‰ object ç±»å‹å­—æ®µè¿›è¡Œ Label Encoding</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line">label_cols = df.select_dtypes(include=<span class="string">&#x27;object&#x27;</span>).columns.tolist()</span><br><span class="line"></span><br><span class="line">le = LabelEncoder()</span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> label_cols:</span><br><span class="line">    df[col] = le.fit_transform(df[col])</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç¼–ç åæ•°æ®ç±»å‹</span></span><br><span class="line">df.dtypes</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<pre><code>customerID            int64
gender                int64
SeniorCitizen         int64
Partner               int64
Dependents            int64
tenure                int64
PhoneService          int64
MultipleLines         int64
InternetService       int64
OnlineSecurity        int64
OnlineBackup          int64
DeviceProtection      int64
TechSupport           int64
StreamingTV           int64
StreamingMovies       int64
Contract              int64
PaperlessBilling      int64
PaymentMethod         int64
MonthlyCharges      float64
TotalCharges        float64
Churn                 int64
dtype: object
</code></pre>
<p>âš ï¸ æ³¨æ„ï¼šæœ¬é¡¹ç›®ä½¿ç”¨ Pipeline å¯¹æ¨¡å‹è¿›è¡Œå°è£…ï¼Œå› æ­¤æˆ‘ä»¬ä¸åœ¨æ­¤é˜¶æ®µç›´æ¥æ‰§è¡Œæ•°å€¼ç‰¹å¾çš„ç¼©æ”¾æ“ä½œã€‚</p>
<p>æˆ‘ä»¬å°†åœ¨åç»­çš„æ¨¡å‹è®­ç»ƒä¸­ï¼Œé€šè¿‡ <code>ColumnTransformer + StandardScaler</code> ç»Ÿä¸€ç®¡ç†æ•°å€¼ç‰¹å¾çš„ç¼©æ”¾ï¼Œä»¥ç¡®ä¿ä¸åŒæ¨¡å‹ä½¿ç”¨å„è‡ªå¯¹åº”çš„é¢„å¤„ç†æ–¹å¼ã€‚</p>
<h3 id="3-3-ç‰¹å¾ç¼©æ”¾"><a href="#3-3-ç‰¹å¾ç¼©æ”¾" class="headerlink" title="3.3 ç‰¹å¾ç¼©æ”¾"></a>3.3 ç‰¹å¾ç¼©æ”¾</h3><p>âš ï¸ æ³¨æ„ï¼šåŸæœ¬å‡†å¤‡ä½¿ç”¨Pipeline å¯¹æ¨¡å‹è¿›è¡Œå°è£…ï¼Œå› æ­¤æˆ‘ä»¬ä¸åœ¨æ­¤é˜¶æ®µç›´æ¥æ‰§è¡Œæ•°å€¼ç‰¹å¾çš„ç¼©æ”¾æ“ä½œï¼Œä½†è€ƒè™‘åˆ°é¡¾å®¢æµå¤±åŸå› åˆ†æã€‚å¯¹æ¨¡å‹è§£é‡ŠSHAPéå¸¸é‡è¦ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬é™ç»´æ¯ä¸ªæ¨¡å‹è®¾ç½®åˆé€‚çš„ç¼©æ”¾å™¨ç®¡ç†ï¼Œåˆ†å¼€ä¿å­˜</p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>æ¨èç¼©æ”¾æ–¹æ³•</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>Logistic Regression&#x2F; SVM</td>
<td>StandardScaler</td>
<td>æ¢¯åº¦ä¸‹é™å¯¹ç‰¹å¾å°ºåº¦æ•æ„Ÿ</td>
</tr>
<tr>
<td>KNN</td>
<td>MinMaxScaler</td>
<td>è·ç¦»è®¡ç®—æ•æ„Ÿï¼Œéœ€è¦å½’ä¸€åŒ–</td>
</tr>
<tr>
<td>Neural Network</td>
<td>MinMax æˆ– Standard</td>
<td>æœ‰åŠ©äºå¿«é€Ÿæ”¶æ•›</td>
</tr>
<tr>
<td>Random Forest &#x2F; XGBoost</td>
<td>æ— éœ€ç¼©æ”¾</td>
<td>åŸºäºæ ‘åˆ†è£‚ï¼Œæ•°å€¼å¤§å°æ— å½±å“</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler, MinMaxScaler</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹†åˆ†ç‰¹å¾å’Œæ ‡ç­¾</span></span><br><span class="line">X = df.drop(<span class="string">&#x27;Churn&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">y = df[<span class="string">&#x27;Churn&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹†åˆ†è®­ç»ƒå’Œæµ‹è¯•é›†ï¼ˆStratify ä¿è¯æ ‡ç­¾å¹³è¡¡ï¼‰</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">    X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">42</span>, stratify=y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æ•°å€¼åˆ—ï¼ˆéœ€è¦ç¼©æ”¾ï¼‰</span></span><br><span class="line">num_cols = [<span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Logistic / SVM ä½¿ç”¨ StandardScaler</span></span><br><span class="line">std_scaler = StandardScaler()</span><br><span class="line">X_train_std = X_train.copy()</span><br><span class="line">X_test_std = X_test.copy()</span><br><span class="line">X_train_std[num_cols] = std_scaler.fit_transform(X_train[num_cols])</span><br><span class="line">X_test_std[num_cols] = std_scaler.transform(X_test[num_cols])</span><br><span class="line"></span><br><span class="line"><span class="comment"># KNN / MLP ä½¿ç”¨ MinMaxScaler</span></span><br><span class="line">mm_scaler = MinMaxScaler()</span><br><span class="line">X_train_mm = X_train.copy()</span><br><span class="line">X_test_mm = X_test.copy()</span><br><span class="line">X_train_mm[num_cols] = mm_scaler.fit_transform(X_train[num_cols])</span><br><span class="line">X_test_mm[num_cols] = mm_scaler.transform(X_test[num_cols])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Random Forest / XGBoost ä½¿ç”¨åŸå§‹æ•°æ®ï¼ˆä¸ç¼©æ”¾ï¼‰</span></span><br><span class="line">X_train_raw = X_train.copy()</span><br><span class="line">X_test_raw = X_test.copy()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="4-æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰"><a href="#4-æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰" class="headerlink" title="4. æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰"></a>4. æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰</h2><h3 id="4-1-ç›®æ ‡å˜é‡åˆ†å¸ƒï¼ˆChurn-æ¦‚å†µï¼‰"><a href="#4-1-ç›®æ ‡å˜é‡åˆ†å¸ƒï¼ˆChurn-æ¦‚å†µï¼‰" class="headerlink" title="4.1 ç›®æ ‡å˜é‡åˆ†å¸ƒï¼ˆChurn æ¦‚å†µï¼‰"></a>4.1 ç›®æ ‡å˜é‡åˆ†å¸ƒï¼ˆChurn æ¦‚å†µï¼‰</h3><p>é¦–å…ˆæŸ¥çœ‹ç›®æ ‡å˜é‡ <code>Churn</code> çš„æ€»ä½“åˆ†å¸ƒï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ï¼Œä»¥ä¾¿åç»­è€ƒè™‘æ˜¯å¦éœ€è¦è¿‡é‡‡æ ·&#x2F;æ¬ é‡‡æ ·æˆ–åŠ æƒã€‚</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸»é¢˜</span></span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”» Churn åˆ†å¸ƒæŸ±çŠ¶å›¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">6</span>, <span class="number">4</span>))</span><br><span class="line">sns.countplot(x=<span class="string">&#x27;Churn&#x27;</span>, data=df, palette=<span class="string">&#x27;Set2&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Customer churn distribution (0 = no churn, 1 = churn)&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Whether it is lost&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Number of customers&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæµå¤±æ¯”ä¾‹</span></span><br><span class="line">churn_rate = df[<span class="string">&#x27;Churn&#x27;</span>].value_counts(normalize=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š Churn rateï¼ˆChurn=1ï¼‰:&quot;</span>, <span class="built_in">round</span>(churn_rate[<span class="number">1</span>]*<span class="number">100</span>, <span class="number">2</span>), <span class="string">&quot;%&quot;</span>)</span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_23_0.png" alt="png"><br>â€‹    </p>
<pre><code>ğŸ“Š Churn rateï¼ˆChurn=1ï¼‰: 26.58 %
</code></pre>
<h4 id="âš–ï¸-ç±»åˆ«ä¸å¹³è¡¡å¤„ç†æ–¹æ³•è¯´æ˜"><a href="#âš–ï¸-ç±»åˆ«ä¸å¹³è¡¡å¤„ç†æ–¹æ³•è¯´æ˜" class="headerlink" title="âš–ï¸ ç±»åˆ«ä¸å¹³è¡¡å¤„ç†æ–¹æ³•è¯´æ˜"></a>âš–ï¸ ç±»åˆ«ä¸å¹³è¡¡å¤„ç†æ–¹æ³•è¯´æ˜</h4><p>åœ¨ Telco æ•°æ®é›†ä¸­ï¼Œå®¢æˆ·æµå¤±ï¼ˆChurn&#x3D;1ï¼‰ä»…å çº¦ 26%ï¼Œå­˜åœ¨æ˜æ˜¾ç±»åˆ«ä¸å¹³è¡¡ã€‚</p>
<p>ä¸ºäº†è§£å†³æ¨¡å‹å¯èƒ½å¿½è§†å°‘æ•°ç±»ï¼ˆæµå¤±å®¢æˆ·ï¼‰çš„é£é™©ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä»¥ä¸‹ç­–ç•¥ï¼š</p>
<ul>
<li><strong>è¿‡é‡‡æ ·ï¼ˆOversamplingï¼‰</strong>ï¼šå¢åŠ å°‘æ•°ç±»æ ·æœ¬</li>
<li><strong>æ¬ é‡‡æ ·ï¼ˆUndersamplingï¼‰</strong>ï¼šå‡å°‘å¤šæ•°ç±»æ ·æœ¬</li>
<li><strong>ç±»åˆ«åŠ æƒï¼ˆClass Weightingï¼‰</strong>ï¼šå¯¹å°‘æ•°ç±»æ–½åŠ æ›´é«˜è®­ç»ƒæƒé‡ï¼ˆæ¨èï¼‰</li>
</ul>
<p>æœ¬é¡¹ç›®åç»­åœ¨å»ºæ¨¡ä¸­å°†é‡‡ç”¨ <code>class_weight=&#39;balanced&#39;</code> å‚æ•°ï¼Œæé«˜æ¨¡å‹å¯¹æµå¤±å®¢æˆ·çš„è¯†åˆ«èƒ½åŠ›ã€‚</p>
<h3 id="4-2-ğŸ‘¨â€ğŸ‘©â€ğŸ‘§-ç±»åˆ«å˜é‡-vs-æµå¤±ç‡ï¼ˆå•å˜é‡åˆ†æï¼‰"><a href="#4-2-ğŸ‘¨â€ğŸ‘©â€ğŸ‘§-ç±»åˆ«å˜é‡-vs-æµå¤±ç‡ï¼ˆå•å˜é‡åˆ†æï¼‰" class="headerlink" title="4.2 ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç±»åˆ«å˜é‡ vs. æµå¤±ç‡ï¼ˆå•å˜é‡åˆ†æï¼‰"></a>4.2 ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç±»åˆ«å˜é‡ vs. æµå¤±ç‡ï¼ˆå•å˜é‡åˆ†æï¼‰</h3><p>æˆ‘ä»¬åˆ†ææ¯ä¸ªç±»åˆ«å˜é‡ä¸‹çš„æµå¤±ç‡ï¼Œå¸®åŠ©æˆ‘ä»¬åˆ¤æ–­å“ªäº›ç‰¹å¾ä¸æµå¤±é«˜åº¦ç›¸å…³ã€‚é‡ç‚¹è€ƒå¯Ÿï¼š</p>
<ul>
<li><code>gender</code></li>
<li><code>SeniorCitizen</code></li>
<li><code>Partner</code></li>
<li><code>Contract</code></li>
<li><code>InternetService</code></li>
<li><code>PaymentMethod</code></li>
</ul>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰ä½ æƒ³åˆ†æçš„ç±»åˆ«å˜é‡</span></span><br><span class="line">cat_vars = [<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;SeniorCitizen&#x27;</span>, <span class="string">&#x27;Partner&#x27;</span>, <span class="string">&#x27;Dependents&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;PhoneService&#x27;</span>, <span class="string">&#x27;MultipleLines&#x27;</span>, <span class="string">&#x27;InternetService&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;Contract&#x27;</span>, <span class="string">&#x27;PaymentMethod&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–æ¯ä¸ªç±»åˆ«å˜é‡ä¸‹çš„æµå¤±ç‡</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">18</span>, <span class="number">15</span>))</span><br><span class="line"><span class="keyword">for</span> i, var <span class="keyword">in</span> <span class="built_in">enumerate</span>(cat_vars):</span><br><span class="line">    plt.subplot(<span class="number">4</span>, <span class="number">3</span>, i+<span class="number">1</span>)</span><br><span class="line">    sns.barplot(x=var, y=<span class="string">&#x27;Churn&#x27;</span>, data=df, ci=<span class="literal">None</span>, palette=<span class="string">&#x27;Set3&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">f&quot;<span class="subst">&#123;var&#125;</span> vs. Churn&quot;</span>)</span><br><span class="line">    plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_27_0.png" alt="png"><br>â€‹    </p>
<p>ç±»åˆ«å˜é‡ vs. æµå¤±ç‡åˆ†æï¼ˆç»“æœè§£è¯»ï¼‰</p>
<p>ä»¥ä¸‹æ˜¯å„ç±»åˆ«å˜é‡åœ¨ä¸åŒå–å€¼ä¸‹çš„å®¢æˆ·æµå¤±ç‡ï¼ˆChurn&#x3D;1ï¼‰æŸ±çŠ¶å›¾ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­å‘ç°ä¸€äº›æ˜æ˜¾çš„è§„å¾‹ï¼š</p>
<ul>
<li><p><strong>Contractï¼ˆåˆåŒç±»å‹ï¼‰</strong>ï¼šå½±å“æœ€å¤§ã€‚é€‰æ‹© <strong>Month-to-monthï¼ˆæœˆåº¦åˆåŒï¼‰</strong> çš„å®¢æˆ·æµå¤±ç‡æ˜æ˜¾é«˜äºä¸€å¹´&#x2F;ä¸¤å¹´åˆçº¦å®¢æˆ·ï¼Œè¯´æ˜<strong>é•¿æœŸåˆåŒæœ‰åŠ©äºé™ä½æµå¤±ç‡</strong>ã€‚</p>
</li>
<li><p><strong>PaymentMethodï¼ˆæ”¯ä»˜æ–¹å¼ï¼‰</strong>ï¼šä½¿ç”¨ <strong>Electronic checkï¼ˆç”µå­æ”¯ç¥¨ï¼‰</strong> çš„å®¢æˆ·æµå¤±ç‡æœ€é«˜ï¼Œå¯èƒ½æ„å‘³ç€è¿™ç±»ç”¨æˆ·ä»˜æ¬¾æ–¹å¼çµæ´»ã€ç¨³å®šæ€§å·®ã€‚</p>
</li>
<li><p><strong>OnlineSecurity &#x2F; TechSupport &#x2F; InternetService</strong>ï¼šæ²¡æœ‰è¿™äº›æœåŠ¡ï¼ˆæˆ–æœªè®¢é˜…ç½‘ç»œæœåŠ¡ï¼‰çš„å®¢æˆ·ï¼Œæµå¤±ç‡æ™®éè¾ƒé«˜ï¼Œè¯´æ˜<strong>åŸºç¡€æœåŠ¡ä¸é™„åŠ ä¿éšœåŠŸèƒ½å¯èƒ½æé«˜ç”¨æˆ·é»æ€§</strong>ã€‚</p>
</li>
<li><p><strong>Partner &#x2F; Dependentsï¼ˆæ˜¯å¦æœ‰é…å¶æˆ–å­å¥³ï¼‰</strong>ï¼šæœ‰å®¶åº­è´£ä»»çš„å®¢æˆ·æµå¤±ç‡æ›´ä½ï¼Œå¯èƒ½ä½“ç°äº†è¿™ç±»ç”¨æˆ·å¯¹æœåŠ¡çš„ä¾èµ–æ€§æ›´é«˜ã€‚</p>
</li>
<li><p><strong>SeniorCitizen &#x2F; PhoneService &#x2F; MultipleLines &#x2F; gender</strong>ï¼šè¿™äº›å˜é‡çš„å½±å“ç›¸å¯¹è¾ƒå¼±ï¼Œæ€§åˆ«å‡ ä¹ä¸å½±å“æµå¤±è¡Œä¸ºï¼›æ˜¯å¦ä¸ºè€å¹´äººç•¥æœ‰å·®å¼‚ä½†ä¸æ˜¾è‘—ã€‚</p>
</li>
</ul>
<p>è¿™äº›å‘ç°ä¸ºæˆ‘ä»¬åç»­ç‰¹å¾é€‰æ‹©å’Œæ¨¡å‹è®­ç»ƒæä¾›äº†æœ‰ä»·å€¼çš„ä¾æ®ï¼Œç‰¹åˆ«æ˜¯ï¼š</p>
<ul>
<li><code>Contract</code>, <code>PaymentMethod</code>, <code>OnlineSecurity</code>, <code>InternetService</code> ç­‰å˜é‡åº”é‡ç‚¹å…³æ³¨ï¼›</li>
<li><code>gender</code>, <code>PhoneService</code> å¯ä½œä¸ºæ¬¡è¦å˜é‡å¤„ç†ã€‚</li>
</ul>
<h3 id="4-3-ğŸ“‰-æ•°å€¼å˜é‡åœ¨ä¸åŒæµå¤±çŠ¶æ€ä¸‹çš„åˆ†å¸ƒï¼ˆç®±çº¿å›¾åˆ†æï¼‰"><a href="#4-3-ğŸ“‰-æ•°å€¼å˜é‡åœ¨ä¸åŒæµå¤±çŠ¶æ€ä¸‹çš„åˆ†å¸ƒï¼ˆç®±çº¿å›¾åˆ†æï¼‰" class="headerlink" title="4.3 ğŸ“‰ æ•°å€¼å˜é‡åœ¨ä¸åŒæµå¤±çŠ¶æ€ä¸‹çš„åˆ†å¸ƒï¼ˆç®±çº¿å›¾åˆ†æï¼‰"></a>4.3 ğŸ“‰ æ•°å€¼å˜é‡åœ¨ä¸åŒæµå¤±çŠ¶æ€ä¸‹çš„åˆ†å¸ƒï¼ˆç®±çº¿å›¾åˆ†æï¼‰</h3><p>æˆ‘ä»¬ä½¿ç”¨ç®±çº¿å›¾å¯¹æ•°å€¼å˜é‡è¿›è¡Œåˆ†ç»„å¯è§†åŒ–ï¼Œè§‚å¯Ÿä¸åŒæµå¤±çŠ¶æ€ä¸‹çš„å®¢æˆ·åœ¨ <code>tenure</code>, <code>MonthlyCharges</code>, <code>TotalCharges</code> ä¸‰ä¸ªå…³é”®æŒ‡æ ‡ä¸Šçš„åˆ†å¸ƒå·®å¼‚ã€‚</p>
<p>ç®±çº¿å›¾å¯ä»¥å¸®åŠ©æˆ‘ä»¬è¯†åˆ«ï¼š</p>
<ul>
<li>å‡å€¼&#x2F;ä¸­ä½æ•°æ˜¯å¦æœ‰æ˜¾è‘—å·®å¼‚ï¼›</li>
<li>æ˜¯å¦å­˜åœ¨æç«¯å€¼ï¼›</li>
<li>å“ªäº›ç‰¹å¾èƒ½æ›´å¥½åœ°åŒºåˆ†æµå¤±ä¸å¦ã€‚</li>
</ul>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">18</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># tenure vs. Churn</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">sns.boxplot(x=<span class="string">&#x27;Churn&#x27;</span>, y=<span class="string">&#x27;tenure&#x27;</span>, data=df, palette=<span class="string">&#x27;Set2&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Tenure vs. Churn&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Whether it is lost&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Months onlineï¼ˆtenureï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># MonthlyCharges vs. Churn</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line">sns.boxplot(x=<span class="string">&#x27;Churn&#x27;</span>, y=<span class="string">&#x27;MonthlyCharges&#x27;</span>, data=df, palette=<span class="string">&#x27;Set3&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;MonthlyCharges vs. Churn&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Whether it is lost&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Monthly Fees&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># TotalCharges vs. Churn</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">sns.boxplot(x=<span class="string">&#x27;Churn&#x27;</span>, y=<span class="string">&#x27;TotalCharges&#x27;</span>, data=df, palette=<span class="string">&#x27;Set1&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;TotalCharges vs. Churn&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Whether it is lost&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Total cost&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_31_0.png" alt="png"><br>â€‹    </p>
<h5 id="âœ…-tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰"><a href="#âœ…-tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰" class="headerlink" title="âœ… tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰"></a>âœ… tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰</h5><ul>
<li><strong>æœªæµå¤±ç”¨æˆ·ï¼ˆChurn&#x3D;0ï¼‰</strong>ï¼šä¸­ä½æ•°åœ¨çº¦ 45 ä¸ªæœˆï¼Œæ•´ä½“åˆ†å¸ƒé›†ä¸­åœ¨ 20ï½70 ä¸ªæœˆã€‚</li>
<li><strong>æµå¤±ç”¨æˆ·ï¼ˆChurn&#x3D;1ï¼‰</strong>ï¼šä¸­ä½æ•°æ˜æ˜¾è¾ƒä½ï¼Œä»…çº¦ 10 ä¸ªæœˆï¼Œå¤§é‡é›†ä¸­åœ¨å‰ 1ï½20 æœˆã€‚</li>
</ul>
<p>ğŸ‘‰ <strong>è§£è¯»</strong>ï¼šæ–°ç”¨æˆ·æ›´å®¹æ˜“æµå¤±ï¼Œå®¢æˆ·åœ¨ç½‘æ—¶é—´è¶Šé•¿ï¼Œæµå¤±å¯èƒ½æ€§è¶Šä½ã€‚è¿™è¯´æ˜å¿ è¯šå®¢æˆ·ç•™å­˜æ•ˆæœæ˜¾è‘—ã€‚</p>
<hr>
<h5 id="âœ…-MonthlyChargesï¼ˆæœˆåº¦æ”¶è´¹ï¼‰"><a href="#âœ…-MonthlyChargesï¼ˆæœˆåº¦æ”¶è´¹ï¼‰" class="headerlink" title="âœ… MonthlyChargesï¼ˆæœˆåº¦æ”¶è´¹ï¼‰"></a>âœ… MonthlyChargesï¼ˆæœˆåº¦æ”¶è´¹ï¼‰</h5><ul>
<li><strong>æµå¤±ç”¨æˆ·</strong>çš„æœˆåº¦è´¹ç”¨ <strong>ä¸­ä½æ•°æ›´é«˜</strong>ï¼Œåˆ†å¸ƒåå³ï¼ˆè¾ƒå¤§å€¼æ›´å¤šï¼‰ã€‚</li>
<li><strong>æœªæµå¤±ç”¨æˆ·</strong>æœˆæ¶ˆè´¹åˆ†å¸ƒæ›´å¹¿ï¼Œä½è´¹ç”¨ç”¨æˆ·æ›´å¤šã€‚</li>
</ul>
<p>ğŸ‘‰ <strong>è§£è¯»</strong>ï¼šé«˜æœˆæ¶ˆè´¹å®¢æˆ·å¯èƒ½å¯¹ä»·æ ¼æ›´æ•æ„Ÿï¼Œæˆ–è€…ä½¿ç”¨äº†æ›´å¤šæœåŠ¡ï¼Œå› æ­¤æµå¤±ç‡åé«˜ã€‚åº”è€ƒè™‘æ˜¯å¦æä¾›é•¿æœŸåˆåŒæˆ–ä¼˜æƒ ç­–ç•¥æ¥é™ä½è¿™ç±»ç”¨æˆ·çš„æµå¤±ã€‚</p>
<hr>
<h5 id="âœ…-TotalChargesï¼ˆæ€»è´¹ç”¨ï¼‰"><a href="#âœ…-TotalChargesï¼ˆæ€»è´¹ç”¨ï¼‰" class="headerlink" title="âœ… TotalChargesï¼ˆæ€»è´¹ç”¨ï¼‰"></a>âœ… TotalChargesï¼ˆæ€»è´¹ç”¨ï¼‰</h5><ul>
<li><strong>æœªæµå¤±ç”¨æˆ·</strong>çš„æ€»è´¹ç”¨åˆ†å¸ƒæ›´å®½ï¼Œæœ€é«˜è¾¾ 8600+ï¼Œä¸­ä½æ•°çº¦ä¸º 2300ã€‚</li>
<li><strong>æµå¤±ç”¨æˆ·</strong>ä¸­ä½æ•°å¾ˆä½ï¼Œçº¦ä¸º 400ï¼Œä¸”å‡ºç°å¤šä¸ªå¼‚å¸¸å€¼ï¼ˆä¸Šæ–¹å°åœ†ç‚¹ï¼‰ã€‚</li>
</ul>
<p>ğŸ‘‰ <strong>è§£è¯»</strong>ï¼šTotalCharges æœ¬è´¨å— tenure å½±å“è¾ƒå¤§ã€‚æµå¤±ç”¨æˆ·å› ä¸ºåœ¨ç½‘æ—¶é—´çŸ­ï¼Œæ€»è´¹ç”¨åä½ã€‚æ­¤ç‰¹å¾ä¸ tenure æœ‰ä¸€å®šç›¸å…³æ€§ï¼Œä½†ä¾ç„¶å…·æœ‰åŒºåˆ†èƒ½åŠ›ã€‚</p>
<hr>
<h4 id="ğŸ”-å°ç»“å»ºè®®"><a href="#ğŸ”-å°ç»“å»ºè®®" class="headerlink" title="ğŸ” å°ç»“å»ºè®®"></a>ğŸ” å°ç»“å»ºè®®</h4><ul>
<li><strong>tenure</strong> æ˜¯å½±å“æµå¤±æœ€æ˜æ˜¾çš„å˜é‡ï¼Œæ¨¡å‹åº”é‡ç‚¹è€ƒè™‘ï¼›</li>
<li><strong>MonthlyCharges</strong> ä¸å®¢æˆ·æ»¡æ„åº¦&#x2F;ä»·æ ¼æ•æ„Ÿåº¦ç›¸å…³ï¼Œä¹Ÿéœ€é‡ç‚¹å¼•å…¥ï¼›</li>
<li><strong>TotalCharges</strong> è™½ç„¶ä¸ tenure é«˜ç›¸å…³ï¼Œä½†ä»èƒ½æä¾›ä»·å€¼ï¼Œå»ºè®®ä¿ç•™ã€‚</li>
</ul>
<p>åç»­å¯ä»¥è¿›ä¸€æ­¥é€šè¿‡ç›¸å…³æ€§çƒ­åŠ›å›¾ç¡®è®¤å˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨å¤šé‡å…±çº¿ã€‚</p>
<h3 id="4-4-ğŸ”¥-ç‰¹å¾ç›¸å…³æ€§çƒ­åŠ›å›¾"><a href="#4-4-ğŸ”¥-ç‰¹å¾ç›¸å…³æ€§çƒ­åŠ›å›¾" class="headerlink" title="4.4 ğŸ”¥ ç‰¹å¾ç›¸å…³æ€§çƒ­åŠ›å›¾"></a>4.4 ğŸ”¥ ç‰¹å¾ç›¸å…³æ€§çƒ­åŠ›å›¾</h3><p>æˆ‘ä»¬ä½¿ç”¨ <code>df.corr()</code> è®¡ç®—å˜é‡ä¹‹é—´çš„ Pearson ç›¸å…³ç³»æ•°ï¼Œå¹¶é€šè¿‡çƒ­åŠ›å›¾å¯è§†åŒ–å„ç‰¹å¾ä¹‹é—´çš„çº¿æ€§ç›¸å…³æ€§ã€‚</p>
<ul>
<li>æ·±è‰²ä»£è¡¨ç›¸å…³æ€§å¼ºï¼ˆæ­£&#x2F;è´Ÿï¼‰</li>
<li><code>Churn</code> ä¸å…¶ä»–å˜é‡çš„ç›¸å…³æ€§å¯ä»¥æ­ç¤ºå“ªäº›ç‰¹å¾æ˜¯æ½œåœ¨çš„é¢„æµ‹å› å­</li>
<li>è‹¥ä¸¤ä¸ªè¾“å…¥ç‰¹å¾é«˜åº¦ç›¸å…³ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘é™ç»´æˆ–å»é™¤å…¶ä¸­ä¹‹ä¸€ï¼ˆé¿å…å…±çº¿æ€§ï¼‰</li>
</ul>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">14</span>, <span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ç›¸å…³ç³»æ•°çŸ©é˜µ</span></span><br><span class="line">corr_matrix = df.corr()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”»çƒ­åŠ›å›¾</span></span><br><span class="line">sns.heatmap(corr_matrix, annot=<span class="literal">True</span>, fmt=<span class="string">&quot;.2f&quot;</span>, cmap=<span class="string">&#x27;coolwarm&#x27;</span>, center=<span class="number">0</span>,</span><br><span class="line">            linewidths=<span class="number">0.5</span>, linecolor=<span class="string">&#x27;gray&#x27;</span>, square=<span class="literal">True</span>, cbar_kws=&#123;<span class="string">&quot;shrink&quot;</span>: <span class="number">.6</span>&#125;)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&quot;ğŸ“Š Feature Correlation Heatmapï¼ˆPearsonï¼‰&quot;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">plt.yticks(rotation=<span class="number">0</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_35_0.png" alt="png"><br>â€‹    </p>
<h5 id="âœ…-ä¸ç›®æ ‡å˜é‡-Churn-çš„ç›¸å…³æ€§"><a href="#âœ…-ä¸ç›®æ ‡å˜é‡-Churn-çš„ç›¸å…³æ€§" class="headerlink" title="âœ… ä¸ç›®æ ‡å˜é‡ Churn çš„ç›¸å…³æ€§"></a>âœ… ä¸ç›®æ ‡å˜é‡ <code>Churn</code> çš„ç›¸å…³æ€§</h5><ul>
<li><p><strong>tenure</strong> ä¸ Churn çš„ç›¸å…³æ€§æœ€å¼ºï¼ˆ-0.35ï¼‰ï¼Œä¸ºè´Ÿç›¸å…³<br>ğŸ‘‰ åœ¨ç½‘æ—¶é—´è¶Šé•¿ï¼Œå®¢æˆ·è¶Šä¸å®¹æ˜“æµå¤±ï¼Œç¬¦åˆä¸šåŠ¡ç›´è§‰</p>
</li>
<li><p><strong>OnlineSecurity</strong>ï¼ˆ-0.28ï¼‰ã€<strong>TechSupport</strong>ï¼ˆ-0.27ï¼‰ã€<strong>Contract</strong>ï¼ˆ-0.39ï¼‰ä¹Ÿå‘ˆè´Ÿç›¸å…³<br>ğŸ‘‰ è¯´æ˜ä½¿ç”¨ä¿éšœæœåŠ¡ã€ç­¾è®¢é•¿æœŸåˆåŒçš„ç”¨æˆ·æ›´ç¨³å®š</p>
</li>
<li><p><strong>MonthlyCharges</strong>ï¼ˆ+0.19ï¼‰ä¸ºå°‘æ•°æ­£ç›¸å…³çš„æ•°å€¼å˜é‡<br>ğŸ‘‰ æ¶ˆè´¹è¶Šé«˜çš„ç”¨æˆ·æµå¤±ç‡ç•¥é«˜ï¼Œå¯èƒ½å­˜åœ¨ä»·æ ¼æ•æ„Ÿé—®é¢˜</p>
</li>
</ul>
<hr>
<h5 id="âš ï¸-ç‰¹å¾ä¹‹é—´çš„å¼ºç›¸å…³æ€§ï¼ˆæ½œåœ¨å†—ä½™ï¼‰"><a href="#âš ï¸-ç‰¹å¾ä¹‹é—´çš„å¼ºç›¸å…³æ€§ï¼ˆæ½œåœ¨å†—ä½™ï¼‰" class="headerlink" title="âš ï¸ ç‰¹å¾ä¹‹é—´çš„å¼ºç›¸å…³æ€§ï¼ˆæ½œåœ¨å†—ä½™ï¼‰"></a>âš ï¸ ç‰¹å¾ä¹‹é—´çš„å¼ºç›¸å…³æ€§ï¼ˆæ½œåœ¨å†—ä½™ï¼‰</h5><ul>
<li><p><code>TotalCharges</code> ä¸ <code>tenure</code> ç›¸å…³æ€§é«˜è¾¾ <strong>+0.83</strong><br>ğŸ‘‰ å¯èƒ½å­˜åœ¨ä¿¡æ¯é‡å ï¼ˆTotalCharges &#x3D; MonthlyCharges Ã— tenure çš„è¿‘ä¼¼å‡½æ•°ï¼‰ï¼Œåœ¨ä½¿ç”¨çº¿æ€§æ¨¡å‹æ—¶éœ€æ³¨æ„å…±çº¿æ€§é—®é¢˜</p>
</li>
<li><p><code>OnlineSecurity</code>, <code>OnlineBackup</code>, <code>TechSupport</code> å½¼æ­¤ä¹Ÿå­˜åœ¨ä¸­åº¦ç›¸å…³ï¼ˆçº¦ 0.3~0.4ï¼‰<br>ğŸ‘‰ å¯è§†ä¸ºâ€œé™„åŠ æœåŠ¡ç¾¤â€ï¼Œä¹Ÿè®¸åæœŸå¯ä»¥è€ƒè™‘æ„é€ ä¸€ä¸ªæœåŠ¡åˆæˆç‰¹å¾</p>
</li>
</ul>
<hr>
<h4 id="âœ…-å»ºè®®ï¼ˆä¸ºåç»­å»ºæ¨¡åšå‡†å¤‡ï¼‰"><a href="#âœ…-å»ºè®®ï¼ˆä¸ºåç»­å»ºæ¨¡åšå‡†å¤‡ï¼‰" class="headerlink" title="âœ… å»ºè®®ï¼ˆä¸ºåç»­å»ºæ¨¡åšå‡†å¤‡ï¼‰"></a>âœ… å»ºè®®ï¼ˆä¸ºåç»­å»ºæ¨¡åšå‡†å¤‡ï¼‰</h4><ul>
<li><strong>ä¿ç•™ç‰¹å¾</strong>ï¼š<code>tenure</code>, <code>MonthlyCharges</code>, <code>Contract</code>, <code>OnlineSecurity</code>, <code>TechSupport</code> æ˜¯é«˜ä»·å€¼å˜é‡ï¼Œåº”é‡ç‚¹å…³æ³¨</li>
<li><strong>éœ€æ³¨æ„å†—ä½™</strong>ï¼š<code>TotalCharges</code> ä¸ <code>tenure</code> å¯æ‹©ä¸€ä½¿ç”¨äºçº¿æ€§æ¨¡å‹ä¸­ï¼Œæˆ–é€šè¿‡ PCA é™ç»´</li>
<li><strong>ä¸å»ºè®®åˆ é™¤ä½†å½±å“è¾ƒå°çš„ç‰¹å¾</strong>ï¼šå¦‚ <code>gender</code>, <code>PhoneService</code>, <code>DeviceProtection</code>ï¼Œå¯ä»¥åœ¨åç»­æ¨¡å‹ä¸­è¿›è¡Œé‡è¦æ€§è¯„ä¼°</li>
</ul>
<h3 id="4-5-ğŸ¯-æ•°å€¼å˜é‡åˆ†å¸ƒå›¾ï¼ˆæŒ‰æµå¤±æƒ…å†µåˆ†ç»„ï¼‰"><a href="#4-5-ğŸ¯-æ•°å€¼å˜é‡åˆ†å¸ƒå›¾ï¼ˆæŒ‰æµå¤±æƒ…å†µåˆ†ç»„ï¼‰" class="headerlink" title="4.5 ğŸ¯ æ•°å€¼å˜é‡åˆ†å¸ƒå›¾ï¼ˆæŒ‰æµå¤±æƒ…å†µåˆ†ç»„ï¼‰"></a>4.5 ğŸ¯ æ•°å€¼å˜é‡åˆ†å¸ƒå›¾ï¼ˆæŒ‰æµå¤±æƒ…å†µåˆ†ç»„ï¼‰</h3><p>æˆ‘ä»¬å°†ç›®æ ‡å˜é‡ <code>Churn</code> ä½œä¸ºåˆ†ç»„æ¡ä»¶ï¼Œåˆ†åˆ«ç»˜åˆ¶ä¸»è¦æ•°å€¼å˜é‡çš„åˆ†å¸ƒå›¾ã€‚</p>
<p>æœ¬èŠ‚é‡ç‚¹åˆ†æï¼š</p>
<ul>
<li><code>tenure</code>ï¼šåœ¨ç½‘æ—¶é•¿</li>
<li><code>MonthlyCharges</code>ï¼šæœˆåº¦æ¶ˆè´¹é‡‘é¢</li>
<li><code>TotalCharges</code>ï¼šç´¯è®¡æ¶ˆè´¹é‡‘é¢</li>
</ul>
<p>é€šè¿‡å¯¹æ¯”æµå¤± vs æœªæµå¤±äººç¾¤åœ¨å„å˜é‡ä¸Šçš„åˆ†å¸ƒå·®å¼‚ï¼Œè¾…åŠ©åˆ¤æ–­å˜é‡çš„åŒºåˆ†èƒ½åŠ›å’Œæ½œåœ¨å½±å“ã€‚</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®é£æ ¼</span></span><br><span class="line">sns.<span class="built_in">set</span>(style=<span class="string">&quot;whitegrid&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å›¾å½¢åŒºåŸŸ</span></span><br><span class="line">plt.figure(figsize=(<span class="number">18</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># tenure åˆ†å¸ƒ</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">sns.kdeplot(data=df, x=<span class="string">&#x27;tenure&#x27;</span>, hue=<span class="string">&#x27;Churn&#x27;</span>, fill=<span class="literal">True</span>, common_norm=<span class="literal">False</span>, palette=<span class="string">&#x27;Set2&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;tenure distribution - grouped by churn&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># MonthlyCharges åˆ†å¸ƒ</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>)</span><br><span class="line">sns.kdeplot(data=df, x=<span class="string">&#x27;MonthlyCharges&#x27;</span>, hue=<span class="string">&#x27;Churn&#x27;</span>, fill=<span class="literal">True</span>, common_norm=<span class="literal">False</span>, palette=<span class="string">&#x27;Set1&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;MonthlyCharges distribution - grouped by churn&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># TotalCharges åˆ†å¸ƒ</span></span><br><span class="line">plt.subplot(<span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">sns.kdeplot(data=df, x=<span class="string">&#x27;TotalCharges&#x27;</span>, hue=<span class="string">&#x27;Churn&#x27;</span>, fill=<span class="literal">True</span>, common_norm=<span class="literal">False</span>, palette=<span class="string">&#x27;Set3&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;TotalCharges distribution - grouped by churn&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_39_0.png" alt="png"><br>â€‹    </p>
<h5 id="1ï¸âƒ£-tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰"><a href="#1ï¸âƒ£-tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰" class="headerlink" title="1ï¸âƒ£ tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰"></a>1ï¸âƒ£ <code>tenure</code>ï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰</h5><ul>
<li><strong>æµå¤±ç”¨æˆ·ï¼ˆChurn&#x3D;1ï¼‰</strong>ï¼šåˆ†å¸ƒé›†ä¸­äºå·¦ä¾§ï¼ˆä½ tenureï¼‰ï¼Œåœ¨ 0â€“15 æœˆå†…å‡ºç°å¯†é›†å³°å€¼</li>
<li><strong>æœªæµå¤±ç”¨æˆ·ï¼ˆChurn&#x3D;0ï¼‰</strong>ï¼šåˆ†å¸ƒæ›´åŠ å‡åŒ€ï¼Œä¸­é•¿ tenure å®¢æˆ·æ¯”ä¾‹è¾ƒé«˜</li>
</ul>
<p>ğŸ“Œ <strong>è§£è¯»</strong>ï¼šè¯´æ˜æ–°æ³¨å†Œç”¨æˆ·æ›´å®¹æ˜“æµå¤±ï¼Œ<code>tenure</code> æ˜¯éå¸¸å…³é”®çš„æµå¤±é¢„æµ‹å› å­ã€‚</p>
<hr>
<h5 id="2ï¸âƒ£-MonthlyChargesï¼ˆæœˆåº¦æ¶ˆè´¹ï¼‰"><a href="#2ï¸âƒ£-MonthlyChargesï¼ˆæœˆåº¦æ¶ˆè´¹ï¼‰" class="headerlink" title="2ï¸âƒ£ MonthlyChargesï¼ˆæœˆåº¦æ¶ˆè´¹ï¼‰"></a>2ï¸âƒ£ <code>MonthlyCharges</code>ï¼ˆæœˆåº¦æ¶ˆè´¹ï¼‰</h5><ul>
<li><strong>æµå¤±ç”¨æˆ·</strong>ï¼šåˆ†å¸ƒæ›´â€œåå³â€ï¼Œå³é«˜è´¹ç”¨ç¾¤ä½“æµå¤±ç‡è¾ƒé«˜</li>
<li><strong>æœªæµå¤±ç”¨æˆ·</strong>ï¼šåœ¨ä¸­ä½æ¶ˆè´¹æ®µï¼ˆçº¦ $20â€“70ï¼‰è¾ƒä¸ºé›†ä¸­</li>
</ul>
<p>ğŸ“Œ <strong>è§£è¯»</strong>ï¼šé«˜æ¶ˆè´¹å®¢æˆ·å¯èƒ½å¯¹æœåŠ¡è´¨é‡æˆ–ä»·æ ¼æ›´æ•æ„Ÿï¼Œå› æ­¤éœ€è¦æ›´å¤šä¿ç•™ç­–ç•¥ï¼ˆå¦‚æ‰“åŒ…ä¼˜æƒ ã€é•¿æœŸåˆåŒç­‰ï¼‰ã€‚</p>
<hr>
<h5 id="3ï¸âƒ£-TotalChargesï¼ˆæ€»æ¶ˆè´¹é‡‘é¢ï¼‰"><a href="#3ï¸âƒ£-TotalChargesï¼ˆæ€»æ¶ˆè´¹é‡‘é¢ï¼‰" class="headerlink" title="3ï¸âƒ£ TotalChargesï¼ˆæ€»æ¶ˆè´¹é‡‘é¢ï¼‰"></a>3ï¸âƒ£ <code>TotalCharges</code>ï¼ˆæ€»æ¶ˆè´¹é‡‘é¢ï¼‰</h5><ul>
<li><strong>æµå¤±ç”¨æˆ·</strong>ï¼šåˆ†å¸ƒéå¸¸é›†ä¸­äºä½å€¼åŒºåŸŸï¼ˆ&lt; $2000ï¼‰ï¼Œä¸”å³å°¾å¿«é€Ÿè¡°å‡</li>
<li><strong>æœªæµå¤±ç”¨æˆ·</strong>ï¼šåˆ†å¸ƒæ›´å®½ï¼Œå°¾éƒ¨å»¶å±•è‡³ $8000 ä»¥ä¸Š</li>
</ul>
<p>ğŸ“Œ <strong>è§£è¯»</strong>ï¼šTotalCharges åœ¨ä¸€å®šç¨‹åº¦ä¸Šå— <code>tenure</code> æ§åˆ¶ï¼Œè¯´æ˜å¤šæ•°æµå¤±ç”¨æˆ·åœ¨ç½‘æ—¶é—´çŸ­ã€ç´¯è®¡è´¹ç”¨å°‘ã€‚</p>
<hr>
<h4 id="âœ…-ç»¼åˆç»“è®º"><a href="#âœ…-ç»¼åˆç»“è®º" class="headerlink" title="âœ… ç»¼åˆç»“è®º"></a>âœ… ç»¼åˆç»“è®º</h4><ul>
<li><code>tenure</code> æ˜¯æœ€å…·åŒºåˆ†åŠ›çš„å˜é‡ï¼Œå¯¹æµå¤±è¯†åˆ«ä½œç”¨æœ€æ˜æ˜¾</li>
<li><code>MonthlyCharges</code> æä¾›äº†ç‹¬ç«‹äº tenure çš„åŒºåˆ†ä¿¡æ¯ï¼Œå°¤å…¶æ˜¯å¯¹é«˜æ¶ˆè´¹äººç¾¤</li>
<li><code>TotalCharges</code> ä¸ <code>tenure</code> å¼ºç›¸å…³ï¼Œåœ¨éçº¿æ€§æ¨¡å‹ä¸­ä»å¯ä¿ç•™ï¼Œåœ¨é€»è¾‘å›å½’ä¸­å»ºè®®ä¸å…¶ä»–å˜é‡æ­é…ä½¿ç”¨</li>
</ul>
<h3 id="4-6-ğŸ”-é«˜é˜¶ç»„åˆç‰¹å¾äº¤å‰åˆ†æ"><a href="#4-6-ğŸ”-é«˜é˜¶ç»„åˆç‰¹å¾äº¤å‰åˆ†æ" class="headerlink" title="4.6 ğŸ” é«˜é˜¶ç»„åˆç‰¹å¾äº¤å‰åˆ†æ"></a>4.6 ğŸ” é«˜é˜¶ç»„åˆç‰¹å¾äº¤å‰åˆ†æ</h3><p>æœ¬èŠ‚é€šè¿‡å¤šä¸ªå…³é”®å˜é‡ç»„åˆè¿›è¡Œäº¤å‰åˆ†ç»„ï¼Œè§‚å¯Ÿä¸åŒç»„åˆä¸‹çš„æµå¤±ç‡å˜åŒ–ï¼Œè¿›ä¸€æ­¥åˆ»ç”»â€œæµå¤±é£é™©ç”¨æˆ·ç”»åƒâ€ã€‚</p>
<hr>
<h4 id="1ï¸âƒ£-Contract-PaymentMethod-å¯¹æµå¤±ç‡çš„å½±å“"><a href="#1ï¸âƒ£-Contract-PaymentMethod-å¯¹æµå¤±ç‡çš„å½±å“" class="headerlink" title="1ï¸âƒ£ Contract + PaymentMethod å¯¹æµå¤±ç‡çš„å½±å“"></a>1ï¸âƒ£ Contract + PaymentMethod å¯¹æµå¤±ç‡çš„å½±å“</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">12</span>, <span class="number">6</span>))</span><br><span class="line">sns.barplot(data=df, x=<span class="string">&#x27;Contract&#x27;</span>, y=<span class="string">&#x27;Churn&#x27;</span>, hue=<span class="string">&#x27;PaymentMethod&#x27;</span>, palette=<span class="string">&#x27;Set2&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Contract + PaymentMethod Impact on churn rate&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Churn rate&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Contract Type&quot;</span>)</span><br><span class="line">plt.legend(title=<span class="string">&#x27;Payment Methods&#x27;</span>, bbox_to_anchor=(<span class="number">1.05</span>, <span class="number">1</span>), loc=<span class="string">&#x27;upper left&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_44_0.png" alt="png"><br>â€‹    </p>
<h4 id="2ï¸âƒ£-InternetService-OnlineSecurity-ç»„åˆåˆ†æ"><a href="#2ï¸âƒ£-InternetService-OnlineSecurity-ç»„åˆåˆ†æ" class="headerlink" title="2ï¸âƒ£ InternetService + OnlineSecurity ç»„åˆåˆ†æ"></a>2ï¸âƒ£ InternetService + OnlineSecurity ç»„åˆåˆ†æ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">5</span>))</span><br><span class="line">sns.barplot(data=df, x=<span class="string">&#x27;InternetService&#x27;</span>, y=<span class="string">&#x27;Churn&#x27;</span>, hue=<span class="string">&#x27;OnlineSecurity&#x27;</span>, palette=<span class="string">&#x27;Set1&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;Impact of network type + security service combination on churn rate&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Churn rate&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Network service type&quot;</span>)</span><br><span class="line">plt.legend(title=<span class="string">&#x27;Whether to use security services&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_46_0.png" alt="png"><br>â€‹    </p>
<h4 id="3ï¸âƒ£-MonthlyCharges-tenureï¼ˆåˆ†ç®±ï¼‰-ç»„åˆåˆ†æ"><a href="#3ï¸âƒ£-MonthlyCharges-tenureï¼ˆåˆ†ç®±ï¼‰-ç»„åˆåˆ†æ" class="headerlink" title="3ï¸âƒ£ MonthlyCharges + tenureï¼ˆåˆ†ç®±ï¼‰ ç»„åˆåˆ†æ"></a>3ï¸âƒ£ MonthlyCharges + tenureï¼ˆåˆ†ç®±ï¼‰ ç»„åˆåˆ†æ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¹ tenure åˆ†ç®±ï¼ˆåˆ’åˆ†æˆæ–°å®¢æˆ·ã€ä¸­æœŸå®¢æˆ·ã€è€å®¢æˆ·ï¼‰</span></span><br><span class="line">df[<span class="string">&#x27;tenure_group&#x27;</span>] = pd.cut(df[<span class="string">&#x27;tenure&#x27;</span>], bins=[<span class="number">0</span>, <span class="number">12</span>, <span class="number">36</span>, <span class="number">72</span>], labels=[<span class="string">&#x27;çŸ­æœŸ&#x27;</span>, <span class="string">&#x27;ä¸­æœŸ&#x27;</span>, <span class="string">&#x27;é•¿æœŸ&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† MonthlyCharges ç¦»æ•£åŒ–</span></span><br><span class="line">df[<span class="string">&#x27;charge_level&#x27;</span>] = pd.cut(df[<span class="string">&#x27;MonthlyCharges&#x27;</span>], bins=[<span class="number">0</span>, <span class="number">40</span>, <span class="number">70</span>, <span class="number">120</span>], labels=[<span class="string">&#x27;ä½&#x27;</span>, <span class="string">&#x27;ä¸­&#x27;</span>, <span class="string">&#x27;é«˜&#x27;</span>])</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">sns.barplot(data=df, x=<span class="string">&#x27;tenure_group&#x27;</span>, y=<span class="string">&#x27;Churn&#x27;</span>, hue=<span class="string">&#x27;charge_level&#x27;</span>, palette=<span class="string">&#x27;Set3&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;The impact of monthly consumption level + customer age group on churn rate&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Churn rate&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Customer life cycle stages&quot;</span>)</span><br><span class="line">plt.legend(title=<span class="string">&#x27;Consumption Level&#x27;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_48_0.png" alt="png"><br>â€‹    </p>
<h2 id="5-å»ºæ¨¡ä¸è¯„ä¼°"><a href="#5-å»ºæ¨¡ä¸è¯„ä¼°" class="headerlink" title="5. å»ºæ¨¡ä¸è¯„ä¼°"></a>5. å»ºæ¨¡ä¸è¯„ä¼°</h2><h3 id="5-1-å»ºæ¨¡"><a href="#5-1-å»ºæ¨¡" class="headerlink" title="5.1 å»ºæ¨¡"></a>5.1 å»ºæ¨¡</h3><h4 id="5-1-1ï¼šLogistic-Regression"><a href="#5-1-1ï¼šLogistic-Regression" class="headerlink" title="5.1.1ï¼šLogistic Regression"></a>5.1.1ï¼šLogistic Regression</h4><p>ä½¿ç”¨æ ‡å‡†åŒ–åçš„ç‰¹å¾ï¼ˆStandardScalerï¼‰è®­ç»ƒé€»è¾‘å›å½’æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨åŠ æƒç­–ç•¥ï¼ˆclass_weight&#x3D;â€™balancedâ€™ï¼‰æå‡æ¨¡å‹å¯¹å°‘æ•°ç±»ï¼ˆChurn&#x3D;1ï¼‰çš„æ•æ„Ÿåº¦ã€‚</p>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">log_model = LogisticRegression(class_weight=<span class="string">&#x27;balanced&#x27;</span>, max_iter=<span class="number">1000</span>, random_state=<span class="number">42</span>)</span><br><span class="line">log_model.fit(X_train_std, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">y_pred_log = log_model.predict(X_test_std)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºè¯„ä¼°æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š Logistic Regression Evaluation:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred_log, target_names=[<span class="string">&quot;Not Churned&quot;</span>, <span class="string">&quot;Churned&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å•ç‹¬æå–å››é¡¹æ ¸å¿ƒæŒ‡æ ‡ï¼ˆä¾¿äºåç»­æ±‡æ€»ï¼‰</span></span><br><span class="line">log_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Logistic Regression&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_log),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_log),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_log),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_log)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Š Logistic Regression Evaluation:
              precision    recall  f1-score   support

 Not Churned       0.91      0.70      0.79      1033
     Churned       0.49      0.80      0.61       374

    accuracy                           0.73      1407
   macro avg       0.70      0.75      0.70      1407
weighted avg       0.80      0.73      0.74      1407
</code></pre>
<p>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> ConfusionMatrixDisplay</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">ConfusionMatrixDisplay.from_estimator(</span><br><span class="line">    log_model, X_test_std, y_test,</span><br><span class="line">    display_labels=[<span class="string">&#x27;Not Churned&#x27;</span>, <span class="string">&#x27;Churned&#x27;</span>],</span><br><span class="line">    cmap=plt.cm.Blues</span><br><span class="line">)</span><br><span class="line">plt.title(<span class="string">&quot;Confusion Matrix - Logistic Regression&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_54_0.png" alt="png"><br>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">all_metrics = []</span><br><span class="line">all_metrics.append(log_metrics)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-1-2ï¼šSVM"><a href="#5-1-2ï¼šSVM" class="headerlink" title="5.1.2ï¼šSVM"></a>5.1.2ï¼šSVM</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">svm_model = SVC(class_weight=<span class="string">&#x27;balanced&#x27;</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, probability=<span class="literal">True</span>, random_state=<span class="number">42</span>)</span><br><span class="line">svm_model.fit(X_train_std, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">y_pred_svm = svm_model.predict(X_test_std)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºè¯„ä¼°æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š SVM Evaluation:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred_svm, target_names=[<span class="string">&quot;Not Churned&quot;</span>, <span class="string">&quot;Churned&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å‚¨æŒ‡æ ‡ç»“æœ</span></span><br><span class="line">svm_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Support Vector Machine&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_svm),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_svm),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_svm),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_svm)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Š SVM Evaluation:
              precision    recall  f1-score   support

 Not Churned       0.74      0.40      0.52      1033
     Churned       0.27      0.61      0.38       374

    accuracy                           0.46      1407
   macro avg       0.51      0.51      0.45      1407
weighted avg       0.62      0.46      0.48      1407
</code></pre>
<p>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> ConfusionMatrixDisplay</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">ConfusionMatrixDisplay.from_estimator(</span><br><span class="line">    svm_model, X_test_std, y_test,</span><br><span class="line">    display_labels=[<span class="string">&#x27;Not Churned&#x27;</span>, <span class="string">&#x27;Churned&#x27;</span>],</span><br><span class="line">    cmap=plt.cm.Purples</span><br><span class="line">)</span><br><span class="line">plt.title(<span class="string">&quot;Confusion Matrix - SVM&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_58_0.png" alt="png"><br>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">all_metrics.append(svm_metrics)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-1-3ï¼šKNN"><a href="#5-1-3ï¼šKNN" class="headerlink" title="5.1.3ï¼šKNN"></a>5.1.3ï¼šKNN</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒï¼ˆé»˜è®¤ k=5ï¼Œå¯è°ƒï¼‰</span></span><br><span class="line">knn_model = KNeighborsClassifier(n_neighbors=<span class="number">5</span>)</span><br><span class="line">knn_model.fit(X_train_mm, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">y_pred_knn = knn_model.predict(X_test_mm)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºè¯„ä¼°æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š KNN Evaluation:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred_knn, target_names=[<span class="string">&quot;Not Churned&quot;</span>, <span class="string">&quot;Churned&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å‚¨æŒ‡æ ‡ç»“æœ</span></span><br><span class="line">knn_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;K-Nearest Neighbors&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_knn),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_knn),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_knn),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_knn)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Š KNN Evaluation:
              precision    recall  f1-score   support

 Not Churned       0.77      0.86      0.81      1033
     Churned       0.42      0.27      0.33       374

    accuracy                           0.71      1407
   macro avg       0.59      0.57      0.57      1407
weighted avg       0.67      0.71      0.68      1407
</code></pre>
<p>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ConfusionMatrixDisplay.from_estimator(</span><br><span class="line">    knn_model, X_test_mm, y_test,</span><br><span class="line">    display_labels=[<span class="string">&#x27;Not Churned&#x27;</span>, <span class="string">&#x27;Churned&#x27;</span>],</span><br><span class="line">    cmap=plt.cm.Greens</span><br><span class="line">)</span><br><span class="line">plt.title(<span class="string">&quot;Confusion Matrix - KNN&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_62_0.png" alt="png"><br>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">all_metrics.append(knn_metrics)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="5-1-4ï¼šRandom-Forest"><a href="#5-1-4ï¼šRandom-Forest" class="headerlink" title="5.1.4ï¼šRandom Forest"></a>5.1.4ï¼šRandom Forest</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">rf_model = RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rf_model.fit(X_train_raw, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred_rf = rf_model.predict(X_test_raw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºè¯„ä¼°æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š Random Forest Evaluation:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred_rf, target_names=[<span class="string">&quot;Not Churned&quot;</span>, <span class="string">&quot;Churned&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å‚¨æŒ‡æ ‡</span></span><br><span class="line">rf_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Random Forest&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_rf),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_rf),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_rf),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_rf)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åˆ°æ€»è¡¨</span></span><br><span class="line">all_metrics.append(rf_metrics)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Š Random Forest Evaluation:
              precision    recall  f1-score   support

 Not Churned       0.83      0.89      0.86      1033
     Churned       0.63      0.51      0.56       374

    accuracy                           0.79      1407
   macro avg       0.73      0.70      0.71      1407
weighted avg       0.78      0.79      0.78      1407
</code></pre>
<p>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ConfusionMatrixDisplay.from_estimator(</span><br><span class="line">    rf_model, X_test_raw, y_test,</span><br><span class="line">    display_labels=[<span class="string">&#x27;Not Churned&#x27;</span>, <span class="string">&#x27;Churned&#x27;</span>],</span><br><span class="line">    cmap=plt.cm.Oranges</span><br><span class="line">)</span><br><span class="line">plt.title(<span class="string">&quot;Confusion Matrix - Random Forest&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_66_0.png" alt="png"><br>â€‹    </p>
<h4 id="5-1-5ï¼šXGBoost"><a href="#5-1-5ï¼šXGBoost" class="headerlink" title="5.1.5ï¼šXGBoost"></a>5.1.5ï¼šXGBoost</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–å¹¶è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">xgb_model_raw = XGBClassifier(</span><br><span class="line">    use_label_encoder=<span class="literal">False</span>,</span><br><span class="line">    eval_metric=<span class="string">&#x27;logloss&#x27;</span>,</span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line">xgb_model_raw.fit(X_train_raw, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred_xgb = xgb_model_raw.predict(X_test_raw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºè¯„ä¼°æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š XGBoost Evaluation:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred_xgb, target_names=[<span class="string">&quot;Not Churned&quot;</span>, <span class="string">&quot;Churned&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å‚¨æŒ‡æ ‡</span></span><br><span class="line">xgb_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;XGBoost&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_xgb),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_xgb),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_xgb),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_xgb)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åˆ°æ€»è¡¨</span></span><br><span class="line">all_metrics.append(xgb_metrics)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Š XGBoost Evaluation:
              precision    recall  f1-score   support

 Not Churned       0.83      0.87      0.85      1033
     Churned       0.59      0.52      0.55       374

    accuracy                           0.78      1407
   macro avg       0.71      0.69      0.70      1407
weighted avg       0.77      0.78      0.77      1407
</code></pre>
<p>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ConfusionMatrixDisplay.from_estimator(</span><br><span class="line">    xgb_model_raw, X_test_raw, y_test,</span><br><span class="line">    display_labels=[<span class="string">&#x27;Not Churned&#x27;</span>, <span class="string">&#x27;Churned&#x27;</span>],</span><br><span class="line">    cmap=plt.cm.Reds</span><br><span class="line">)</span><br><span class="line">plt.title(<span class="string">&quot;Confusion Matrix - XGBoost&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_69_0.png" alt="png"><br>â€‹    </p>
<h4 id="5-1-6ï¼šNeural-Networkï¼ˆMLPï¼‰"><a href="#5-1-6ï¼šNeural-Networkï¼ˆMLPï¼‰" class="headerlink" title="5.1.6ï¼šNeural Networkï¼ˆMLPï¼‰"></a>5.1.6ï¼šNeural Networkï¼ˆMLPï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neural_network <span class="keyword">import</span> MLPClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–ç¥ç»ç½‘ç»œæ¨¡å‹</span></span><br><span class="line">mlp_model = MLPClassifier(</span><br><span class="line">    hidden_layer_sizes=(<span class="number">64</span>,),  <span class="comment"># ä¸€ä¸ªéšå±‚ï¼Œ64ä¸ªç¥ç»å…ƒï¼ˆå¯è°ƒï¼‰</span></span><br><span class="line">    activation=<span class="string">&#x27;relu&#x27;</span>,</span><br><span class="line">    solver=<span class="string">&#x27;adam&#x27;</span>,</span><br><span class="line">    max_iter=<span class="number">300</span>,</span><br><span class="line">    random_state=<span class="number">42</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">mlp_model.fit(X_train_mm, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹é¢„æµ‹</span></span><br><span class="line">y_pred_mlp = mlp_model.predict(X_test_mm)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºè¯„ä¼°æŠ¥å‘Š</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ğŸ“Š Neural Network (MLP) Evaluation:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred_mlp, target_names=[<span class="string">&quot;Not Churned&quot;</span>, <span class="string">&quot;Churned&quot;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­˜å‚¨æŒ‡æ ‡</span></span><br><span class="line">mlp_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Neural Network (MLP)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_mlp),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_mlp),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_mlp),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_mlp)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ åˆ°æ±‡æ€»åˆ—è¡¨</span></span><br><span class="line">all_metrics.append(mlp_metrics)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>ğŸ“Š Neural Network (MLP) Evaluation:
              precision    recall  f1-score   support

 Not Churned       0.74      0.98      0.85      1033
     Churned       0.55      0.06      0.10       374

    accuracy                           0.74      1407
   macro avg       0.65      0.52      0.47      1407
weighted avg       0.69      0.74      0.65      1407
</code></pre>
<p>â€‹    </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ConfusionMatrixDisplay.from_estimator(</span><br><span class="line">    mlp_model, X_test_mm, y_test,</span><br><span class="line">    display_labels=[<span class="string">&#x27;Not Churned&#x27;</span>, <span class="string">&#x27;Churned&#x27;</span>],</span><br><span class="line">    cmap=plt.cm.Blues</span><br><span class="line">)</span><br><span class="line">plt.title(<span class="string">&quot;Confusion Matrix - Neural Network (MLP)&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_72_0.png" alt="png"><br>â€‹    </p>
<h3 id="5-2-è¯„ä¼°æŒ‡æ ‡ï¼ˆAccuracyã€Recallã€F1ã€ROCï¼‰"><a href="#5-2-è¯„ä¼°æŒ‡æ ‡ï¼ˆAccuracyã€Recallã€F1ã€ROCï¼‰" class="headerlink" title="5.2 è¯„ä¼°æŒ‡æ ‡ï¼ˆAccuracyã€Recallã€F1ã€ROCï¼‰"></a>5.2 è¯„ä¼°æŒ‡æ ‡ï¼ˆAccuracyã€Recallã€F1ã€ROCï¼‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df_metrics = pd.DataFrame(all_metrics)</span><br><span class="line">display(df_metrics.sort_values(by=<span class="string">&#x27;F1-score&#x27;</span>, ascending=<span class="literal">False</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression</td>
      <td>0.727079</td>
      <td>0.491803</td>
      <td>0.802139</td>
      <td>0.609756</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest</td>
      <td>0.788913</td>
      <td>0.627063</td>
      <td>0.508021</td>
      <td>0.561300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>XGBoost</td>
      <td>0.777541</td>
      <td>0.593272</td>
      <td>0.518717</td>
      <td>0.553495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Support Vector Machine</td>
      <td>0.459844</td>
      <td>0.271327</td>
      <td>0.612299</td>
      <td>0.376026</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K-Nearest Neighbors</td>
      <td>0.705757</td>
      <td>0.416667</td>
      <td>0.267380</td>
      <td>0.325733</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Neural Network (MLP)</td>
      <td>0.737029</td>
      <td>0.552632</td>
      <td>0.056150</td>
      <td>0.101942</td>
    </tr>
  </tbody>
</table>
</div>


<h4 id="æ¨¡å‹è¯„ä¼°ç»“æœåˆ†æï¼ˆåˆæ­¥ï¼‰"><a href="#æ¨¡å‹è¯„ä¼°ç»“æœåˆ†æï¼ˆåˆæ­¥ï¼‰" class="headerlink" title="æ¨¡å‹è¯„ä¼°ç»“æœåˆ†æï¼ˆåˆæ­¥ï¼‰"></a>æ¨¡å‹è¯„ä¼°ç»“æœåˆ†æï¼ˆåˆæ­¥ï¼‰</h4><p>ğŸ” åˆæ­¥ç»“è®ºï¼š</p>
<ul>
<li><strong>é€»è¾‘å›å½’ï¼ˆLogistic Regressionï¼‰</strong> è¡¨ç°æœ€ä¸ºç¨³å®šï¼Œåœ¨ä¿æŒè‰¯å¥½ç²¾åº¦çš„åŒæ—¶ï¼ŒRecall è¾¾åˆ° 80%ï¼Œè¯´æ˜å¯¹â€œå®¢æˆ·æµå¤±â€è¿™ä¸€å°‘æ•°ç±»çš„è¯†åˆ«èƒ½åŠ›è¾ƒå¼ºï¼Œæ˜¯å½“å‰è¡¨ç°æœ€å‡è¡¡çš„åŸºçº¿æ¨¡å‹ã€‚</li>
<li><strong>éšæœºæ£®æ—ï¼ˆRandom Forestï¼‰ä¸ XGBoost</strong> åœ¨å‡†ç¡®ç‡ä¸Šé¢†å…ˆï¼Œä½† Recall ç•¥ä½ï¼Œè¯´æ˜å®ƒä»¬æ›´æ“…é•¿è¯†åˆ«å¤šæ•°ç±»å®¢æˆ·ï¼Œå¯èƒ½å¯¼è‡´éƒ¨åˆ†æµå¤±å®¢æˆ·è¢«é”™åˆ¤ä¸ºæœªæµå¤±ã€‚</li>
<li><strong>KNNã€SVM ä¸ç¥ç»ç½‘ç»œï¼ˆMLPï¼‰</strong> è¡¨ç°ä¸ä½³ï¼Œå°¤å…¶æ˜¯ MLP çš„ Recall æä½ï¼Œè¯´æ˜å…¶å¯¹å°æ•°æ®é›†ã€é«˜ç»´ç‰¹å¾ä¸æ•æ„Ÿï¼Œå­˜åœ¨æ˜æ˜¾çš„æ¬ æ‹Ÿåˆé—®é¢˜ã€‚</li>
</ul>
<hr>
<p>ğŸ“Œ åç»­ä¼˜åŒ–æ–¹å‘å»ºè®®ï¼š</p>
<ol>
<li><strong>ç‰¹å¾é‡è¦æ€§åˆ†æ</strong>ï¼šæå–å‰ 10 ä¸ªé‡è¦ç‰¹å¾ï¼Œå°è¯•ç®€åŒ–è¾“å…¥ç»´åº¦ã€‚</li>
<li><strong>æ¨¡å‹å¯è§£é‡Šæ€§å¢å¼º</strong>ï¼šä½¿ç”¨ SHAP åˆ†æ XGBoost çš„ç‰¹å¾å½±å“æ–¹å‘ä¸å¼ºåº¦ã€‚</li>
<li><strong>æ„å»ºè½»é‡æ¨¡å‹</strong>ï¼šä»…ä½¿ç”¨ Top-N ç‰¹å¾è®­ç»ƒ LR &#x2F; XGBoostï¼Œå¯¹æ¯”æ€§èƒ½å˜åŒ–ã€‚</li>
<li><strong>æå‡ Precision</strong>ï¼šé€šè¿‡é˜ˆå€¼è°ƒä¼˜ã€æ¨¡å‹èåˆç­‰æ–¹å¼ï¼Œè¿›ä¸€æ­¥æé«˜é¢„æµ‹ç»“æœçš„å¯é æ€§ã€‚</li>
</ol>
<h2 id="6-æ¨¡å‹è§£é‡Š"><a href="#6-æ¨¡å‹è§£é‡Š" class="headerlink" title="6. æ¨¡å‹è§£é‡Š"></a>6. æ¨¡å‹è§£é‡Š</h2><h3 id="6-1-æå–ç‰¹å¾é‡è¦æ€§æ’åï¼ˆæŸ±çŠ¶å›¾"><a href="#6-1-æå–ç‰¹å¾é‡è¦æ€§æ’åï¼ˆæŸ±çŠ¶å›¾" class="headerlink" title="6.1 æå–ç‰¹å¾é‡è¦æ€§æ’åï¼ˆæŸ±çŠ¶å›¾)"></a>6.1 æå–ç‰¹å¾é‡è¦æ€§æ’åï¼ˆæŸ±çŠ¶å›¾)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># æå–ç‰¹å¾é‡è¦æ€§</span></span><br><span class="line">feature_importance = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;feature&#x27;</span>: X_train_raw.columns,</span><br><span class="line">    <span class="string">&#x27;importance&#x27;</span>: xgb_model_raw.feature_importances_</span><br><span class="line">&#125;).sort_values(by=<span class="string">&#x27;importance&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–å‰ 10 ä¸ªç‰¹å¾</span></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">sns.barplot(data=feature_importance.head(<span class="number">10</span>), x=<span class="string">&#x27;importance&#x27;</span>, y=<span class="string">&#x27;feature&#x27;</span>, palette=<span class="string">&#x27;viridis&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;XGBoost Top 10 Feature Importance&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Importance&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Feature&quot;</span>)</span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_79_0.png" alt="png"><br>â€‹    </p>
<h3 id="6-2-XGBoost-å†…ç½®ç‰¹å¾é‡è¦æ€§ï¼ˆGainï¼‰"><a href="#6-2-XGBoost-å†…ç½®ç‰¹å¾é‡è¦æ€§ï¼ˆGainï¼‰" class="headerlink" title="6.2 XGBoost å†…ç½®ç‰¹å¾é‡è¦æ€§ï¼ˆGainï¼‰"></a>6.2 XGBoost å†…ç½®ç‰¹å¾é‡è¦æ€§ï¼ˆGainï¼‰</h3><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒXGBoost çš„ <code>feature_importances_</code> å±æ€§ç»™å‡ºäº†æ¯ä¸ªç‰¹å¾å¯¹æ¨¡å‹åˆ†è£‚èŠ‚ç‚¹â€œå¢ç›Šè´¡çŒ®â€çš„å¹³å‡å æ¯”ã€‚</p>
<ul>
<li><strong>Contractï¼ˆåˆçº¦ç±»å‹ï¼‰</strong> æ˜¾è‘—é«˜äºå…¶ä»–ç‰¹å¾ï¼Œæ˜¯æ¨¡å‹é¢„æµ‹å®¢æˆ·æ˜¯å¦æµå¤±çš„é¦–è¦ä¾æ®ã€‚</li>
<li>å…¶ä»–è¾ƒé‡è¦ç‰¹å¾åŒ…æ‹¬ï¼š<code>InternetService</code>, <code>PhoneService</code>, <code>tenure</code>, <code>StreamingTV</code>, <code>TechSupport</code>ã€‚</li>
<li>æ­¤æ–¹æ³•è™½ç„¶é«˜æ•ˆç›´è§‚ï¼Œä½†<strong>ä¸è€ƒè™‘ç‰¹å¾é—´äº¤äº’</strong>ï¼Œä¸”å¯¹åŒç±»ç‰¹å¾çš„åˆ»ç”»è¾ƒç²—ã€‚</li>
</ul>
<h2 id="7-é‡å»ºæ¨¡å‹-ç‰¹å¾é€‰å–-æ„é€ "><a href="#7-é‡å»ºæ¨¡å‹-ç‰¹å¾é€‰å–-æ„é€ " class="headerlink" title="7. é‡å»ºæ¨¡å‹ ç‰¹å¾é€‰å–&#x2F;æ„é€ "></a>7. é‡å»ºæ¨¡å‹ ç‰¹å¾é€‰å–&#x2F;æ„é€ </h2><h3 id="7-1-é€‰å–é‡è¦ç‰¹å¾é‡å»ºæ¨¡å‹"><a href="#7-1-é€‰å–é‡è¦ç‰¹å¾é‡å»ºæ¨¡å‹" class="headerlink" title="7.1 é€‰å–é‡è¦ç‰¹å¾é‡å»ºæ¨¡å‹"></a>7.1 é€‰å–é‡è¦ç‰¹å¾é‡å»ºæ¨¡å‹</h3><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression</td>
      <td>0.727079</td>
      <td>0.491803</td>
      <td>0.802139</td>
      <td>0.609756</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest</td>
      <td>0.788913</td>
      <td>0.627063</td>
      <td>0.508021</td>
      <td>0.561300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>XGBoost</td>
      <td>0.777541</td>
      <td>0.593272</td>
      <td>0.518717</td>
      <td>0.553495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Support Vector Machine</td>
      <td>0.459844</td>
      <td>0.271327</td>
      <td>0.612299</td>
      <td>0.376026</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K-Nearest Neighbors</td>
      <td>0.705757</td>
      <td>0.416667</td>
      <td>0.267380</td>
      <td>0.325733</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Neural Network (MLP)</td>
      <td>0.737029</td>
      <td>0.552632</td>
      <td>0.056150</td>
      <td>0.101942</td>
    </tr>
  </tbody>
</table>
</div>

<p>é‰´äºåˆæ­¥ç»“æœï¼š</p>
<p>æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€é˜¶æ®µä¼˜åŒ–ä¸­ä¿ç•™ä»¥ä¸‹ä¸‰ç±»è¡¨ç°ä¼˜å¼‚çš„æ¨¡å‹ï¼šLogistic Regressionã€Random Forest ä¸ XGBoostã€‚</p>
<p>å®ƒä»¬åœ¨å½“å‰å…¨ç‰¹å¾ä¸‹å‡è¡¨ç°å‡ºè‰²ï¼ŒF1 åˆ†æ•°é¢†å…ˆï¼Œä¸”å„è‡ªå…·å¤‡ä¸åŒä¼˜åŠ¿ï¼š</p>
<p>Logistic Regression å…·å¤‡é«˜è§£é‡Šæ€§ä¸è‰¯å¥½çš„ Recall</p>
<p>Random Forest å‡†ç¡®ç‡ä¸ç²¾åº¦å…¼é¡¾</p>
<p>XGBoost ç»¼åˆèƒ½åŠ›å¼ºï¼Œå¹¶æ”¯æŒé«˜çº§å¯è§£é‡Šæ€§åˆ†æï¼ˆå¦‚ SHAPï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">top10_features = [</span><br><span class="line">    <span class="string">&#x27;Contract&#x27;</span>, <span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;tenure&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>,<span class="string">&#x27;PaperlessBilling&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;PaymentMethod&#x27;</span>, <span class="string">&#x27;InternetService&#x27;</span>, <span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;MultipleLines&#x27;</span>, <span class="string">&#x27;TechSupport&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºæ–°çš„æ•°æ®é›†</span></span><br><span class="line">X_train_top10 = X_train_raw[top10_features]</span><br><span class="line">X_test_top10 = X_test_raw[top10_features]</span><br></pre></td></tr></table></figure>

<h4 id="7-1-1-Logistic-Regression"><a href="#7-1-1-Logistic-Regression" class="headerlink" title="7.1.1 Logistic Regression"></a>7.1.1 Logistic Regression</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train_top10_std = scaler.fit_transform(X_train_top10)</span><br><span class="line">X_test_top10_std = scaler.transform(X_test_top10)</span><br><span class="line"></span><br><span class="line">lr_top10 = LogisticRegression(class_weight=<span class="string">&#x27;balanced&#x27;</span>, max_iter=<span class="number">1000</span>, random_state=<span class="number">42</span>)</span><br><span class="line">lr_top10.fit(X_train_top10_std, y_train)</span><br><span class="line">y_pred_lr_top10 = lr_top10.predict(X_test_top10_std)</span><br><span class="line"></span><br><span class="line">lr_top10_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Logistic Regression (Top 10)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_lr_top10),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_lr_top10),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_lr_top10),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_lr_top10)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-1-2-Random-Forest"><a href="#7-1-2-Random-Forest" class="headerlink" title="7.1.2 Random Forest"></a>7.1.2 Random Forest</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"></span><br><span class="line">rf_top10 = RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rf_top10.fit(X_train_top10, y_train)</span><br><span class="line">y_pred_rf_top10 = rf_top10.predict(X_test_top10)</span><br><span class="line"></span><br><span class="line">rf_top10_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Random Forest (Top 10)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_rf_top10),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_rf_top10),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_rf_top10),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_rf_top10)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-1-3-XGBoost"><a href="#7-1-3-XGBoost" class="headerlink" title="7.1.3 XGBoost"></a>7.1.3 XGBoost</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"></span><br><span class="line">xgb_top10 = XGBClassifier(use_label_encoder=<span class="literal">False</span>, eval_metric=<span class="string">&#x27;logloss&#x27;</span>, random_state=<span class="number">42</span>)</span><br><span class="line">xgb_top10.fit(X_train_top10, y_train)</span><br><span class="line">y_pred_xgb_top10 = xgb_top10.predict(X_test_top10)</span><br><span class="line"></span><br><span class="line">xgb_top10_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;XGBoost (Top 10)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_xgb_top10),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_xgb_top10),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_xgb_top10),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_xgb_top10)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-1-4-æ‰“åŒ…è¾“å‡º"><a href="#7-1-4-æ‰“åŒ…è¾“å‡º" class="headerlink" title="7.1.4 æ‰“åŒ…è¾“å‡º"></a>7.1.4 æ‰“åŒ…è¾“å‡º</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">top10_results = [lr_top10_metrics, rf_top10_metrics, xgb_top10_metrics]</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df_top10 = pd.DataFrame(top10_results)</span><br><span class="line">display(df_top10)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression (Top 10)</td>
      <td>0.721393</td>
      <td>0.485669</td>
      <td>0.815508</td>
      <td>0.608782</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest (Top 10)</td>
      <td>0.780384</td>
      <td>0.604502</td>
      <td>0.502674</td>
      <td>0.548905</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XGBoost (Top 10)</td>
      <td>0.769012</td>
      <td>0.574924</td>
      <td>0.502674</td>
      <td>0.536377</td>
    </tr>
  </tbody>
</table>
</div>


<h3 id="7-2-ç‰¹å¾æ„é€ "><a href="#7-2-ç‰¹å¾æ„é€ " class="headerlink" title="7.2 ç‰¹å¾æ„é€ "></a>7.2 ç‰¹å¾æ„é€ </h3><table>
<thead>
<tr>
<th>ç‰¹å¾å</th>
<th>ç±»å‹</th>
<th>æ„é€ æ–¹å¼</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><code>AvgCharges</code></td>
<td>æ•°å€¼å‹</td>
<td><code>TotalCharges / tenure</code></td>
<td>æ¯æœˆå¹³å‡èŠ±è´¹ï¼Œåæ˜ å®¢æˆ·ä»·å€¼ï¼ˆæ³¨æ„é™¤ä»¥ 0 çš„å¤„ç†ï¼‰</td>
</tr>
<tr>
<td><code>Contract_MonthlyInteraction</code></td>
<td>æ•°å€¼å‹</td>
<td><code>Contractç¼–ç  Ã— MonthlyCharges</code></td>
<td>åˆçº¦ç±»å‹ä¸æ¶ˆè´¹çš„äº¤äº’ï¼Œæ•æ‰é«˜æœˆè´¹çŸ­çº¦å®¢æˆ·é£é™©</td>
</tr>
<tr>
<td><code>TenureGroup</code></td>
<td>ç±»åˆ«å‹</td>
<td>tenure åˆ†ç®±ï¼ˆ0-12ï¼Œ12-36ï¼Œ36-72ï¼‰</td>
<td>å°†ä½¿ç”¨æ—¶é•¿åˆ†ç»„ï¼Œæ›´ä¾¿äºæ¨¡å‹ç†è§£å®¢æˆ·é˜¶æ®µ</td>
</tr>
<tr>
<td><code>IsHighValueCustomer</code></td>
<td>å¸ƒå°”å‹</td>
<td><code>MonthlyCharges &gt; 80</code></td>
<td>é«˜æ¶ˆè´¹å®¢æˆ·è¯†åˆ«ï¼Œæ ‡è®°ä¸ºé«˜ä»·å€¼æ•æ„Ÿç”¨æˆ·</td>
</tr>
<tr>
<td><code>ServiceCount</code></td>
<td>æ•°å€¼å‹</td>
<td>ç»Ÿè®¡å®¢æˆ·å¯ç”¨çš„æœåŠ¡é¡¹æ•°é‡</td>
<td>æœåŠ¡è¶Šå¤šä»£è¡¨é»æ€§è¶Šå¼ºï¼ˆå¦‚ TechSupportã€StreamingTV ç­‰ï¼‰</td>
</tr>
</tbody></table>
<h4 id="7-3-1-æ„é€ å¢å¼ºç‰¹å¾å‡½æ•°"><a href="#7-3-1-æ„é€ å¢å¼ºç‰¹å¾å‡½æ•°" class="headerlink" title="7.3.1 æ„é€ å¢å¼ºç‰¹å¾å‡½æ•°"></a>7.3.1 æ„é€ å¢å¼ºç‰¹å¾å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_constructed_features</span>(<span class="params">df</span>):</span><br><span class="line">    df = df.copy()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Average monthly charges</span></span><br><span class="line">    df[<span class="string">&#x27;AvgCharges&#x27;</span>] = df[<span class="string">&#x27;TotalCharges&#x27;</span>] / df[<span class="string">&#x27;tenure&#x27;</span>]</span><br><span class="line">    df[<span class="string">&#x27;AvgCharges&#x27;</span>].replace([np.inf, -np.inf], <span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">    df[<span class="string">&#x27;AvgCharges&#x27;</span>].fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Contract type Ã— MonthlyCharges</span></span><br><span class="line">    df[<span class="string">&#x27;Contract_MonthlyInteraction&#x27;</span>] = df[<span class="string">&#x27;Contract&#x27;</span>] * df[<span class="string">&#x27;MonthlyCharges&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Tenure group binning</span></span><br><span class="line">    df[<span class="string">&#x27;TenureGroup&#x27;</span>] = pd.cut(df[<span class="string">&#x27;tenure&#x27;</span>], bins=[<span class="number">0</span>, <span class="number">12</span>, <span class="number">36</span>, <span class="number">72</span>], labels=[<span class="string">&#x27;New&#x27;</span>, <span class="string">&#x27;Mid&#x27;</span>, <span class="string">&#x27;Long&#x27;</span>])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># High-value customer indicator</span></span><br><span class="line">    df[<span class="string">&#x27;IsHighValueCustomer&#x27;</span>] = (df[<span class="string">&#x27;MonthlyCharges&#x27;</span>] &gt; <span class="number">80</span>).astype(<span class="built_in">int</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Total active services</span></span><br><span class="line">    service_cols = [<span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;OnlineBackup&#x27;</span>, <span class="string">&#x27;DeviceProtection&#x27;</span>, </span><br><span class="line">                    <span class="string">&#x27;TechSupport&#x27;</span>, <span class="string">&#x27;StreamingTV&#x27;</span>, <span class="string">&#x27;StreamingMovies&#x27;</span>]</span><br><span class="line">    df[<span class="string">&#x27;ServiceCount&#x27;</span>] = df[service_cols].apply(<span class="keyword">lambda</span> row: <span class="built_in">sum</span>(row == <span class="string">&#x27;Yes&#x27;</span>), axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"><span class="comment"># åº”ç”¨æ„é€ ç‰¹å¾</span></span><br><span class="line">X_train_enhanced = add_constructed_features(X_train_raw)</span><br><span class="line">X_test_enhanced = add_constructed_features(X_test_raw)</span><br></pre></td></tr></table></figure>

<h4 id="7-3-2-ç‰¹å¾é¢„å¤„ç†"><a href="#7-3-2-ç‰¹å¾é¢„å¤„ç†" class="headerlink" title="7.3.2 ç‰¹å¾é¢„å¤„ç†"></a>7.3.2 ç‰¹å¾é¢„å¤„ç†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… Top10 åŸå§‹ç‰¹å¾åˆ—</span></span><br><span class="line">top10_features = [</span><br><span class="line">    <span class="string">&#x27;Contract&#x27;</span>, <span class="string">&#x27;tenure&#x27;</span>, <span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>, <span class="string">&#x27;InternetService&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;TechSupport&#x27;</span>, <span class="string">&#x27;PaymentMethod&#x27;</span>, <span class="string">&#x27;PaperlessBilling&#x27;</span>, <span class="string">&#x27;SeniorCitizen&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ„é€ ç‰¹å¾åˆ—ï¼ˆç¡®ä¿è¿™äº›éƒ½åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰è¿‡ï¼‰</span></span><br><span class="line">constructed_features = [</span><br><span class="line">    <span class="string">&#x27;AvgCharges&#x27;</span>, <span class="string">&#x27;Contract_MonthlyInteraction&#x27;</span>, <span class="string">&#x27;IsHighValueCustomer&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ServiceCount&#x27;</span>, <span class="string">&#x27;TenureGroup&#x27;</span>  <span class="comment"># TenureGroup æ˜¯å¾…ç¼–ç å˜é‡</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… ç»„åˆæ€»ç‰¹å¾åˆ—è¡¨ï¼ˆæ­¤å¤„ä¸åŒ…æ‹¬ TenureGroup çš„ One-Hot ç»“æœï¼‰</span></span><br><span class="line">final_raw_features = top10_features + constructed_features</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æå–å­é›†ï¼ˆå…ˆä¸å¤„ç† One-Hot ç¼–ç ï¼‰</span></span><br><span class="line">X_train_sub = X_train_enhanced[final_raw_features].copy()</span><br><span class="line">X_test_sub = X_test_enhanced[final_raw_features].copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… å¯¹ TenureGroup è¿›è¡Œ OneHot ç¼–ç ï¼ˆdrop=&#x27;first&#x27; é¿å…å†—ä½™ï¼‰</span></span><br><span class="line">encoder = OneHotEncoder(drop=<span class="string">&#x27;first&#x27;</span>, sparse_output=<span class="literal">False</span>, handle_unknown=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">encoded_train = encoder.fit_transform(X_train_sub[[<span class="string">&#x27;TenureGroup&#x27;</span>]])</span><br><span class="line">encoded_test = encoder.transform(X_test_sub[[<span class="string">&#x27;TenureGroup&#x27;</span>]])</span><br><span class="line">encoded_cols = encoder.get_feature_names_out([<span class="string">&#x27;TenureGroup&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ‹¼æ¥å›å»ï¼ˆå¹¶åˆ é™¤åŸå§‹ TenureGroupï¼‰</span></span><br><span class="line">X_train_encoded = pd.DataFrame(encoded_train, columns=encoded_cols, index=X_train_sub.index)</span><br><span class="line">X_test_encoded = pd.DataFrame(encoded_test, columns=encoded_cols, index=X_test_sub.index)</span><br><span class="line"></span><br><span class="line">X_train_enhanced_clean = pd.concat([X_train_sub.drop(columns=[<span class="string">&#x27;TenureGroup&#x27;</span>]), X_train_encoded], axis=<span class="number">1</span>)</span><br><span class="line">X_test_enhanced_clean = pd.concat([X_test_sub.drop(columns=[<span class="string">&#x27;TenureGroup&#x27;</span>]), X_test_encoded], axis=<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="7-4-1-Logistic-Regressionï¼ˆåŸºäºTOP10-å¢å¼ºç‰¹å¾ï¼‰"><a href="#7-4-1-Logistic-Regressionï¼ˆåŸºäºTOP10-å¢å¼ºç‰¹å¾ï¼‰" class="headerlink" title="7.4.1 Logistic Regressionï¼ˆåŸºäºTOP10 + å¢å¼ºç‰¹å¾ï¼‰"></a>7.4.1 Logistic Regressionï¼ˆåŸºäºTOP10 + å¢å¼ºç‰¹å¾ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ‡å‡†åŒ–æ•°å€¼åˆ—ï¼ˆåªé’ˆå¯¹ Logistic Regressionï¼‰</span></span><br><span class="line">numeric_cols = [<span class="string">&#x27;tenure&#x27;</span>, <span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>, <span class="string">&#x27;AvgCharges&#x27;</span>, <span class="string">&#x27;ServiceCount&#x27;</span>, <span class="string">&#x27;Contract_MonthlyInteraction&#x27;</span>]</span><br><span class="line"></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train_log = X_train_enhanced_clean.copy()</span><br><span class="line">X_test_log = X_test_enhanced_clean.copy()</span><br><span class="line"></span><br><span class="line">X_train_log[numeric_cols] = scaler.fit_transform(X_train_log[numeric_cols])</span><br><span class="line">X_test_log[numeric_cols] = scaler.transform(X_test_log[numeric_cols])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">lr_model = LogisticRegression(class_weight=<span class="string">&#x27;balanced&#x27;</span>, max_iter=<span class="number">1000</span>, random_state=<span class="number">42</span>)</span><br><span class="line">lr_model.fit(X_train_log, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred_lr = lr_model.predict(X_test_log)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡æ ‡æ±‡æ€»</span></span><br><span class="line">lr_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Logistic Regression (Top10 + Constructed)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_lr),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_lr),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_lr),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_lr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±•ç¤ºç»“æœ</span></span><br><span class="line">pd.DataFrame([lr_metrics])</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression (Top10 + Constructed)</td>
      <td>0.716418</td>
      <td>0.480253</td>
      <td>0.812834</td>
      <td>0.603774</td>
    </tr>
  </tbody>
</table>
</div>



<h4 id="7-4-2-Random-Forestï¼ˆåŸºäº-Top10-æ„é€ ç‰¹å¾ï¼‰"><a href="#7-4-2-Random-Forestï¼ˆåŸºäº-Top10-æ„é€ ç‰¹å¾ï¼‰" class="headerlink" title="7.4.2 Random Forestï¼ˆåŸºäº Top10 + æ„é€ ç‰¹å¾ï¼‰"></a>7.4.2 Random Forestï¼ˆåŸºäº Top10 + æ„é€ ç‰¹å¾ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">rf_model = RandomForestClassifier(n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rf_model.fit(X_train_enhanced_clean, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred_rf = rf_model.predict(X_test_enhanced_clean)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">rf_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Random Forest (Top10 + Constructed)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_rf),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_rf),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_rf),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_rf)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±•ç¤ºç»“æœ</span></span><br><span class="line">pd.DataFrame([rf_metrics])</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Random Forest (Top10 + Constructed)</td>
      <td>0.779673</td>
      <td>0.604575</td>
      <td>0.494652</td>
      <td>0.544118</td>
    </tr>
  </tbody>
</table>
</div>



<h4 id="7-4-3-XGBoostï¼ˆåŸºäº-Top10-æ„é€ ç‰¹å¾ï¼‰"><a href="#7-4-3-XGBoostï¼ˆåŸºäº-Top10-æ„é€ ç‰¹å¾ï¼‰" class="headerlink" title="7.4.3 XGBoostï¼ˆåŸºäº Top10 + æ„é€ ç‰¹å¾ï¼‰"></a>7.4.3 XGBoostï¼ˆåŸºäº Top10 + æ„é€ ç‰¹å¾ï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è®­ç»ƒ</span></span><br><span class="line">xgb_model = XGBClassifier(use_label_encoder=<span class="literal">False</span>, eval_metric=<span class="string">&#x27;logloss&#x27;</span>, random_state=<span class="number">42</span>)</span><br><span class="line">xgb_model.fit(X_train_enhanced_clean, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">y_pred_xgb = xgb_model.predict(X_test_enhanced_clean)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨¡å‹è¯„ä¼°</span></span><br><span class="line">xgb_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;XGBoost (Top10 + Constructed)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_xgb),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_xgb),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_xgb),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_xgb)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±•ç¤ºç»“æœ</span></span><br><span class="line">pd.DataFrame([xgb_metrics])</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>XGBoost (Top10 + Constructed)</td>
      <td>0.771144</td>
      <td>0.578788</td>
      <td>0.510695</td>
      <td>0.542614</td>
    </tr>
  </tbody>
</table>
</div>



<h3 id="7-4-æ±‡æ€»"><a href="#7-4-æ±‡æ€»" class="headerlink" title="7.4 æ±‡æ€»"></a>7.4 æ±‡æ€»</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ä¸‰ä¸ªç»“æœå­—å…¸åˆå¹¶ä¸ºåˆ—è¡¨</span></span><br><span class="line">all_metrics = [lr_metrics, rf_metrics, xgb_metrics]</span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬ä¸º DataFrame å¹¶æŒ‰ F1-score æ’åº</span></span><br><span class="line">results_df = pd.DataFrame(all_metrics).sort_values(by=<span class="string">&#x27;F1-score&#x27;</span>, ascending=<span class="literal">False</span>).reset_index(drop=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±•ç¤ºç»“æœ</span></span><br><span class="line">results_df.style.set_caption(<span class="string">&quot;ğŸ” Model Comparison (Top10 + Constructed Features)&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<style type="text/css">
</style>
<table id="T_d1be8">
  <caption>ğŸ” Model Comparison (Top10 + Constructed Features)</caption>
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th id="T_d1be8_level0_col0" class="col_heading level0 col0">Model</th>
      <th id="T_d1be8_level0_col1" class="col_heading level0 col1">Accuracy</th>
      <th id="T_d1be8_level0_col2" class="col_heading level0 col2">Precision</th>
      <th id="T_d1be8_level0_col3" class="col_heading level0 col3">Recall</th>
      <th id="T_d1be8_level0_col4" class="col_heading level0 col4">F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_d1be8_level0_row0" class="row_heading level0 row0">0</th>
      <td id="T_d1be8_row0_col0" class="data row0 col0">Logistic Regression (Top10 + Constructed)</td>
      <td id="T_d1be8_row0_col1" class="data row0 col1">0.716418</td>
      <td id="T_d1be8_row0_col2" class="data row0 col2">0.480253</td>
      <td id="T_d1be8_row0_col3" class="data row0 col3">0.812834</td>
      <td id="T_d1be8_row0_col4" class="data row0 col4">0.603774</td>
    </tr>
    <tr>
      <th id="T_d1be8_level0_row1" class="row_heading level0 row1">1</th>
      <td id="T_d1be8_row1_col0" class="data row1 col0">Random Forest (Top10 + Constructed)</td>
      <td id="T_d1be8_row1_col1" class="data row1 col1">0.779673</td>
      <td id="T_d1be8_row1_col2" class="data row1 col2">0.604575</td>
      <td id="T_d1be8_row1_col3" class="data row1 col3">0.494652</td>
      <td id="T_d1be8_row1_col4" class="data row1 col4">0.544118</td>
    </tr>
    <tr>
      <th id="T_d1be8_level0_row2" class="row_heading level0 row2">2</th>
      <td id="T_d1be8_row2_col0" class="data row2 col0">XGBoost (Top10 + Constructed)</td>
      <td id="T_d1be8_row2_col1" class="data row2 col1">0.771144</td>
      <td id="T_d1be8_row2_col2" class="data row2 col2">0.578788</td>
      <td id="T_d1be8_row2_col3" class="data row2 col3">0.510695</td>
      <td id="T_d1be8_row2_col4" class="data row2 col4">0.542614</td>
    </tr>
  </tbody>
</table>




<h2 id="8-ä¸åŒç‰¹å¾é€‰å–-å»ºæ¨¡ç»“æœå¯¹æ¯”"><a href="#8-ä¸åŒç‰¹å¾é€‰å–-å»ºæ¨¡ç»“æœå¯¹æ¯”" class="headerlink" title="8. ä¸åŒç‰¹å¾é€‰å– å»ºæ¨¡ç»“æœå¯¹æ¯”"></a>8. ä¸åŒç‰¹å¾é€‰å– å»ºæ¨¡ç»“æœå¯¹æ¯”</h2><h4 id="å…¨ç‰¹å¾"><a href="#å…¨ç‰¹å¾" class="headerlink" title="å…¨ç‰¹å¾"></a>å…¨ç‰¹å¾</h4><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression</td>
      <td>0.727079</td>
      <td>0.491803</td>
      <td>0.802139</td>
      <td>0.609756</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Random Forest</td>
      <td>0.788913</td>
      <td>0.627063</td>
      <td>0.508021</td>
      <td>0.561300</td>
    </tr>
    <tr>
      <th>4</th>
      <td>XGBoost</td>
      <td>0.777541</td>
      <td>0.593272</td>
      <td>0.518717</td>
      <td>0.553495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Support Vector Machine</td>
      <td>0.459844</td>
      <td>0.271327</td>
      <td>0.612299</td>
      <td>0.376026</td>
    </tr>
    <tr>
      <th>2</th>
      <td>K-Nearest Neighbors</td>
      <td>0.705757</td>
      <td>0.416667</td>
      <td>0.267380</td>
      <td>0.325733</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Neural Network (MLP)</td>
      <td>0.737029</td>
      <td>0.552632</td>
      <td>0.056150</td>
      <td>0.101942</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="TOP10"><a href="#TOP10" class="headerlink" title="TOP10"></a>TOP10</h4><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression (Top 10)</td>
      <td>0.723525</td>
      <td>0.487685</td>
      <td>0.794118</td>
      <td>0.604273</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest (Top 10)</td>
      <td>0.783227</td>
      <td>0.610932</td>
      <td>0.508021</td>
      <td>0.554745</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XGBoost (Top 10)</td>
      <td>0.782516</td>
      <td>0.600592</td>
      <td>0.542781</td>
      <td>0.570225</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="TOP10-æ„é€ ç‰¹å¾"><a href="#TOP10-æ„é€ ç‰¹å¾" class="headerlink" title="TOP10 + æ„é€ ç‰¹å¾"></a>TOP10 + æ„é€ ç‰¹å¾</h4><style type="text/css">
</style>
<table id="T_1f199">
  <caption>ğŸ” Model Comparison (Top10 + Constructed Features)</caption>
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th id="T_1f199_level0_col0" class="col_heading level0 col0">Model</th>
      <th id="T_1f199_level0_col1" class="col_heading level0 col1">Accuracy</th>
      <th id="T_1f199_level0_col2" class="col_heading level0 col2">Precision</th>
      <th id="T_1f199_level0_col3" class="col_heading level0 col3">Recall</th>
      <th id="T_1f199_level0_col4" class="col_heading level0 col4">F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_1f199_level0_row0" class="row_heading level0 row0">0</th>
      <td id="T_1f199_row0_col0" class="data row0 col0">Logistic Regression (Top10 + Constructed)</td>
      <td id="T_1f199_row0_col1" class="data row0 col1">0.716418</td>
      <td id="T_1f199_row0_col2" class="data row0 col2">0.480253</td>
      <td id="T_1f199_row0_col3" class="data row0 col3">0.812834</td>
      <td id="T_1f199_row0_col4" class="data row0 col4">0.603774</td>
    </tr>
    <tr>
      <th id="T_1f199_level0_row1" class="row_heading level0 row1">1</th>
      <td id="T_1f199_row1_col0" class="data row1 col0">Random Forest (Top10 + Constructed)</td>
      <td id="T_1f199_row1_col1" class="data row1 col1">0.779673</td>
      <td id="T_1f199_row1_col2" class="data row1 col2">0.604575</td>
      <td id="T_1f199_row1_col3" class="data row1 col3">0.494652</td>
      <td id="T_1f199_row1_col4" class="data row1 col4">0.544118</td>
    </tr>
    <tr>
      <th id="T_1f199_level0_row2" class="row_heading level0 row2">2</th>
      <td id="T_1f199_row2_col0" class="data row2 col0">XGBoost (Top10 + Constructed)</td>
      <td id="T_1f199_row2_col1" class="data row2 col1">0.771144</td>
      <td id="T_1f199_row2_col2" class="data row2 col2">0.578788</td>
      <td id="T_1f199_row2_col3" class="data row2 col3">0.510695</td>
      <td id="T_1f199_row2_col4" class="data row2 col4">0.542614</td>
    </tr>
  </tbody>
</table>

<h2 id="9-SHAP-åˆ†æï¼ˆåŸºäºXGBoost-é€‰å–ä¸åŒç‰¹å¾è¿›è¡Œï¼‰"><a href="#9-SHAP-åˆ†æï¼ˆåŸºäºXGBoost-é€‰å–ä¸åŒç‰¹å¾è¿›è¡Œï¼‰" class="headerlink" title="9. SHAP åˆ†æï¼ˆåŸºäºXGBoost é€‰å–ä¸åŒç‰¹å¾è¿›è¡Œï¼‰"></a>9. SHAP åˆ†æï¼ˆåŸºäºXGBoost é€‰å–ä¸åŒç‰¹å¾è¿›è¡Œï¼‰</h2><h3 id="9-1-å…¨ç‰¹å¾"><a href="#9-1-å…¨ç‰¹å¾" class="headerlink" title="9.1 å…¨ç‰¹å¾"></a>9.1 å…¨ç‰¹å¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shap</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– TreeExplainer</span></span><br><span class="line">explainer_raw = shap.TreeExplainer(xgb_model_raw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— SHAP å€¼ï¼ˆåŸºäºæµ‹è¯•é›†ï¼‰</span></span><br><span class="line">shap_values_raw = explainer_raw.shap_values(X_test_raw)</span><br><span class="line"><span class="comment"># SHAP Bar Plot â€” æ˜¾ç¤ºå¹³å‡ç‰¹å¾å½±å“åŠ›</span></span><br><span class="line">shap.summary_plot(shap_values_raw, X_test_raw, plot_type=<span class="string">&#x27;bar&#x27;</span>, show=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># SHAP Dot Plot â€” æ¯ä¸ªæ ·æœ¬çš„åˆ†å¸ƒå’Œç‰¹å¾å€¼é¢œè‰²</span></span><br><span class="line">shap.summary_plot(shap_values_raw, X_test_raw, plot_type=<span class="string">&#x27;dot&#x27;</span>, show=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_118_0.png" alt="png"><br>â€‹    </p>
<p><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_118_1.png" alt="png"></p>
<h3 id="9-2-TOP10"><a href="#9-2-TOP10" class="headerlink" title="9.2 TOP10"></a>9.2 TOP10</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shap</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– TreeExplainer</span></span><br><span class="line">explainer_top10 = shap.TreeExplainer(xgb_top10)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— SHAP å€¼</span></span><br><span class="line">shap_values_top10 = explainer_top10.shap_values(X_test_top10)</span><br><span class="line"><span class="comment"># å¹³å‡å½±å“å€¼æ’åºå›¾</span></span><br><span class="line">shap.summary_plot(shap_values_top10, X_test_top10, plot_type=<span class="string">&#x27;bar&#x27;</span>, show=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># æ¯ä¸ªæ ·æœ¬çš„ SHAP åˆ†å¸ƒå’Œç‰¹å¾å€¼é¢œè‰²</span></span><br><span class="line">shap.summary_plot(shap_values_top10, X_test_top10, plot_type=<span class="string">&#x27;dot&#x27;</span>, show=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_120_0.png" alt="png"><br>â€‹    </p>
<p><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_120_1.png" alt="png"></p>
<h3 id="9-3-TOP10-æ„é€ ç‰¹å¾"><a href="#9-3-TOP10-æ„é€ ç‰¹å¾" class="headerlink" title="9.3 TOP10 + æ„é€ ç‰¹å¾"></a>9.3 TOP10 + æ„é€ ç‰¹å¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shap</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ– TreeExplainerï¼ˆå¦‚æœè¿˜æ²¡æ‰§è¡Œï¼‰</span></span><br><span class="line">explainer_constructed = shap.TreeExplainer(xgb_model)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… è®¡ç®— SHAP å€¼ï¼ˆå¿…éœ€ï¼‰</span></span><br><span class="line">shap_values_constructed = explainer_constructed.shap_values(X_test_enhanced_clean)</span><br><span class="line"><span class="comment"># æ¡å½¢å›¾</span></span><br><span class="line">shap.summary_plot(shap_values_constructed, X_test_enhanced_clean, plot_type=<span class="string">&#x27;bar&#x27;</span>, show=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†å¸ƒå›¾</span></span><br><span class="line">shap.summary_plot(shap_values_constructed, X_test_enhanced_clean, plot_type=<span class="string">&#x27;dot&#x27;</span>, show=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_122_0.png" alt="png"><br>â€‹    </p>
<p><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_122_1.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(X_train_sub.columns) == <span class="built_in">list</span>(X_test_sub.columns))</span><br><span class="line"><span class="built_in">print</span>(X_test_sub.columns.difference(X_train_sub.columns))  <span class="comment"># åº”è¯¥ä¸ºç©º</span></span><br><span class="line"><span class="built_in">print</span>(X_train_sub[[<span class="string">&#x27;IsHighValueCustomer&#x27;</span>, <span class="string">&#x27;ServiceCount&#x27;</span>]].describe())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>True
Index([], dtype=&#39;object&#39;)
       IsHighValueCustomer  ServiceCount
count          5625.000000        5625.0
mean              0.382400           0.0
std               0.486017           0.0
min               0.000000           0.0
25%               0.000000           0.0
50%               0.000000           0.0
75%               1.000000           0.0
max               1.000000           0.0
</code></pre>
<h3 id="ğŸ”-SHAP-åˆ†æå¯¹æ¯”ï¼ˆä¸‰ç»„ç‰¹å¾ç‰ˆæœ¬ï¼‰"><a href="#ğŸ”-SHAP-åˆ†æå¯¹æ¯”ï¼ˆä¸‰ç»„ç‰¹å¾ç‰ˆæœ¬ï¼‰" class="headerlink" title="ğŸ” SHAP åˆ†æå¯¹æ¯”ï¼ˆä¸‰ç»„ç‰¹å¾ç‰ˆæœ¬ï¼‰"></a>ğŸ” SHAP åˆ†æå¯¹æ¯”ï¼ˆä¸‰ç»„ç‰¹å¾ç‰ˆæœ¬ï¼‰</h3><h4 id="1-å…¨ç‰¹å¾ç‰ˆæœ¬"><a href="#1-å…¨ç‰¹å¾ç‰ˆæœ¬" class="headerlink" title="1. å…¨ç‰¹å¾ç‰ˆæœ¬"></a>1. å…¨ç‰¹å¾ç‰ˆæœ¬</h4><ul>
<li><strong>ä¸»è¦ç‰¹å¾</strong>ï¼š<ul>
<li><code>Contract</code>ã€<code>MonthlyCharges</code>ã€<code>tenure</code> æ˜¯æœ€ä¸»è¦çš„å½±å“å› ç´ ã€‚</li>
<li>å…¶æ¬¡æ˜¯ <code>TotalCharges</code>ã€<code>customerID</code>ã€<code>PaymentMethod</code> ç­‰ã€‚</li>
</ul>
</li>
<li><strong>è§‚å¯Ÿåˆ°çš„é—®é¢˜</strong>ï¼š<ul>
<li>å­˜åœ¨å¤§é‡å†—ä½™ç‰¹å¾ï¼ˆå¦‚ <code>DeviceProtection</code>, <code>Partner</code>, <code>StreamingMovies</code> ç­‰ï¼‰ï¼Œå¯¹é¢„æµ‹å‡ ä¹æ— è´¡çŒ®ã€‚</li>
<li>æ¨¡å‹å¤æ‚åº¦è¾ƒé«˜ï¼Œå­˜åœ¨è¿‡æ‹Ÿåˆé£é™©ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… é€‚åˆåšå…¨é¢æ€§åˆ†æï¼Œä½†ä¸é€‚åˆéƒ¨ç½²ä¸æ³›åŒ–ã€‚</p>
</blockquote>
<hr>
<h4 id="2-Top10-ç‰¹å¾ç‰ˆæœ¬ï¼ˆåŸºäº-SHAP-æ’åå‰åï¼‰"><a href="#2-Top10-ç‰¹å¾ç‰ˆæœ¬ï¼ˆåŸºäº-SHAP-æ’åå‰åï¼‰" class="headerlink" title="2. Top10 ç‰¹å¾ç‰ˆæœ¬ï¼ˆåŸºäº SHAP æ’åå‰åï¼‰"></a>2. Top10 ç‰¹å¾ç‰ˆæœ¬ï¼ˆåŸºäº SHAP æ’åå‰åï¼‰</h4><ul>
<li><strong>ç‰¹å¾é›†ä¸­æ€§æ›´å¼º</strong>ï¼š<ul>
<li>å…³é”®å˜é‡ä»ç„¶æ˜¯ <code>Contract</code>ã€<code>MonthlyCharges</code>ã€<code>tenure</code> ç­‰ã€‚</li>
</ul>
</li>
<li><strong>æ¨¡å‹ç»“æ„æ›´ç®€æ´</strong>ï¼š<ul>
<li>å»é™¤å†—ä½™ç‰¹å¾åï¼Œæ¨¡å‹è§£é‡ŠåŠ›æ›´å¼ºï¼Œæ€§èƒ½æ›´ç¨³å®šã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>âœ… æ¨èä½œä¸ºå»ºæ¨¡ä¸»åŠ›æ–¹æ¡ˆï¼Œæ˜“äºç†è§£ã€éƒ¨ç½²ä¸ä¼˜åŒ–ã€‚</p>
</blockquote>
<hr>
<h4 id="3-Top10-æ„é€ ç‰¹å¾ç‰ˆæœ¬"><a href="#3-Top10-æ„é€ ç‰¹å¾ç‰ˆæœ¬" class="headerlink" title="3. Top10 + æ„é€ ç‰¹å¾ç‰ˆæœ¬"></a>3. Top10 + æ„é€ ç‰¹å¾ç‰ˆæœ¬</h4><ul>
<li><strong>æœ‰æ•ˆçš„æ–°ç‰¹å¾</strong>ï¼š<ul>
<li><code>AvgCharges</code>ï¼ˆæ€»æ¶ˆè´¹ &#x2F; æœåŠ¡æ—¶é•¿ï¼‰å’Œ <code>Contract_MonthlyInteraction</code> å±•ç¤ºå‡ºè‰¯å¥½çš„æ¨¡å‹è´¡çŒ®ã€‚</li>
</ul>
</li>
<li><strong>ä½è´¡çŒ®ç‰¹å¾</strong>ï¼š<ul>
<li><code>ServiceCount</code>ã€<code>IsHighValueCustomer</code>ã€<code>TenureGroup_*</code>ã€<code>TechSupport</code> ç­‰æ„é€ ç‰¹å¾åœ¨æœ¬æ¨¡å‹ä¸­ SHAP å€¼æ¥è¿‘ 0ï¼Œè¯´æ˜å®ƒä»¬å½“å‰æ¨¡å‹ä¸­æœªå‘æŒ¥æœ‰æ•ˆä½œç”¨ã€‚</li>
</ul>
</li>
<li><strong>ä¼˜åŠ¿ä¸ä¸è¶³</strong>ï¼š<ul>
<li>æ‹“å±•äº†æ¨¡å‹è¡¨è¾¾åŠ›ï¼Œä½†ä¹Ÿå¼•å…¥å†—ä½™ï¼Œéœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h4 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h4><ol>
<li><strong>ç²¾ç®€æ„é€ ç‰¹å¾</strong>ï¼šä¿ç•™ <code>AvgCharges</code>ã€<code>Contract_MonthlyInteraction</code> ç­‰æœ‰æ•ˆç‰¹å¾ã€‚</li>
<li><strong>è¿›è¡Œæ¶ˆèæµ‹è¯•ï¼ˆablationï¼‰</strong>ï¼šéªŒè¯æ¯ä¸ªæ–°ç‰¹å¾çš„æ­£è´Ÿè´¡çŒ®ã€‚</li>
</ol>
<h2 id="10-æ¶ˆèåˆ†æ"><a href="#10-æ¶ˆèåˆ†æ" class="headerlink" title="10. æ¶ˆèåˆ†æ"></a>10. æ¶ˆèåˆ†æ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># ğŸ’¡ ä½ å·²æœ‰çš„åˆ—è¡¨ï¼ˆç”¨äºæ„å»ºåŸºç¡€ selected_featuresï¼‰</span></span><br><span class="line">top10_features = [</span><br><span class="line">    <span class="string">&#x27;Contract&#x27;</span>, <span class="string">&#x27;tenure&#x27;</span>, <span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>, <span class="string">&#x27;InternetService&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;TechSupport&#x27;</span>, <span class="string">&#x27;PaymentMethod&#x27;</span>, <span class="string">&#x27;PaperlessBilling&#x27;</span>, <span class="string">&#x27;SeniorCitizen&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŸå§‹æ„é€ ç‰¹å¾ï¼ˆæ³¨æ„åŒ…å« TenureGroup æ˜¯é€»è¾‘æ€§çš„ï¼‰</span></span><br><span class="line">raw_constructed_features = [</span><br><span class="line">    <span class="string">&#x27;AvgCharges&#x27;</span>, <span class="string">&#x27;Contract_MonthlyInteraction&#x27;</span>, <span class="string">&#x27;IsHighValueCustomer&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;ServiceCount&#x27;</span>, <span class="string">&#x27;TenureGroup&#x27;</span>, <span class="string">&#x27;TenureGroup_Mid&#x27;</span>, <span class="string">&#x27;TenureGroup_Long&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ ¹æ®å®é™…åˆ—è¿‡æ»¤å­˜åœ¨çš„æ„é€ ç‰¹å¾ï¼ˆé‡è¦ï¼ï¼‰</span></span><br><span class="line">available_cols = X_train_enhanced_clean.columns.tolist()</span><br><span class="line">constructed_features = [f <span class="keyword">for</span> f <span class="keyword">in</span> raw_constructed_features <span class="keyword">if</span> f <span class="keyword">in</span> available_cols]</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ¶ˆèåˆ†æä¸»å¾ªç¯</span></span><br><span class="line">ablation_results = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> feature_to_drop <span class="keyword">in</span> constructed_features:</span><br><span class="line">    <span class="comment"># æ„å»ºç‰¹å¾é›†ï¼ˆç§»é™¤è¯¥è½®è¦æ¶ˆèçš„æ„é€ ç‰¹å¾ï¼‰</span></span><br><span class="line">    selected_features = top10_features + [f <span class="keyword">for</span> f <span class="keyword">in</span> constructed_features <span class="keyword">if</span> f != feature_to_drop]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        X_train_ablate = X_train_enhanced_clean[selected_features].copy()</span><br><span class="line">        X_test_ablate = X_test_enhanced_clean[selected_features].copy()</span><br><span class="line"></span><br><span class="line">        model = XGBClassifier(use_label_encoder=<span class="literal">False</span>, eval_metric=<span class="string">&#x27;logloss&#x27;</span>, random_state=<span class="number">42</span>)</span><br><span class="line">        model.fit(X_train_ablate, y_train)</span><br><span class="line">        y_pred = model.predict(X_test_ablate)</span><br><span class="line"></span><br><span class="line">        ablation_results.append(&#123;</span><br><span class="line">            <span class="string">&#x27;Dropped_Feature&#x27;</span>: feature_to_drop,</span><br><span class="line">            <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred),</span><br><span class="line">            <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred),</span><br><span class="line">            <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred)</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">except</span> KeyError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸ è·³è¿‡ç‰¹å¾ <span class="subst">&#123;feature_to_drop&#125;</span>ï¼Œå› åˆ—ä¸å­˜åœ¨ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… è½¬ä¸ºè¡¨æ ¼</span></span><br><span class="line">ablation_df = pd.DataFrame(ablation_results)</span><br><span class="line">ablation_df.sort_values(by=<span class="string">&#x27;F1-score&#x27;</span>, ascending=<span class="literal">False</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ˜¾ç¤ºæˆ–ä¿å­˜</span></span><br><span class="line">display(ablation_df)</span><br><span class="line">ablation_df.to_excel(<span class="string">&quot;ablation_results.xlsx&quot;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Dropped_Feature</th>
      <th>Accuracy</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>TenureGroup_Mid</td>
      <td>0.771855</td>
      <td>0.516043</td>
      <td>0.545969</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ServiceCount</td>
      <td>0.771144</td>
      <td>0.510695</td>
      <td>0.542614</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IsHighValueCustomer</td>
      <td>0.771144</td>
      <td>0.510695</td>
      <td>0.542614</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AvgCharges</td>
      <td>0.769012</td>
      <td>0.508021</td>
      <td>0.539007</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Contract_MonthlyInteraction</td>
      <td>0.769012</td>
      <td>0.505348</td>
      <td>0.537696</td>
    </tr>
  </tbody>
</table>
</div>


<h2 id="11-æœ€ç»ˆå»ºæ¨¡"><a href="#11-æœ€ç»ˆå»ºæ¨¡" class="headerlink" title="11 æœ€ç»ˆå»ºæ¨¡"></a>11 æœ€ç»ˆå»ºæ¨¡</h2><h3 id="11-1-å»ºæ¨¡"><a href="#11-1-å»ºæ¨¡" class="headerlink" title="11.1 å»ºæ¨¡"></a>11.1 å»ºæ¨¡</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… å®šä¹‰æœ€ç»ˆä½¿ç”¨çš„åŸå§‹ Top10 ç‰¹å¾</span></span><br><span class="line">top10_features = [</span><br><span class="line">    <span class="string">&#x27;Contract&#x27;</span>, <span class="string">&#x27;tenure&#x27;</span>, <span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;InternetService&#x27;</span>, <span class="string">&#x27;OnlineSecurity&#x27;</span>, <span class="string">&#x27;TechSupport&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;PaymentMethod&#x27;</span>, <span class="string">&#x27;PaperlessBilling&#x27;</span>, <span class="string">&#x27;SeniorCitizen&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ„é€ ç‰¹å¾ä¸­ä¿ç•™çš„ä¸‰é¡¹ï¼ˆæ¥è‡ªæ¶ˆèåˆ†æç»“æœï¼‰</span></span><br><span class="line">selected_constructed_features = [<span class="string">&#x27;IsHighValueCustomer&#x27;</span>, <span class="string">&#x27;ServiceCount&#x27;</span>, <span class="string">&#x27;TenureGroup&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… åº”ç”¨æ„é€ å‡½æ•°ï¼ˆä½ å·²æœ‰å®šä¹‰ï¼šadd_constructed_featuresï¼‰</span></span><br><span class="line">X_train_enhanced = add_constructed_features(X_train_raw)</span><br><span class="line">X_test_enhanced = add_constructed_features(X_test_raw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æå–åŸå§‹ Top10 + æ„é€ ç‰¹å¾åˆ—</span></span><br><span class="line">final_raw_features = top10_features + selected_constructed_features</span><br><span class="line">X_train_sub = X_train_enhanced[final_raw_features].copy()</span><br><span class="line">X_test_sub = X_test_enhanced[final_raw_features].copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… å¯¹ TenureGroup è¿›è¡Œ One-Hot ç¼–ç ï¼ˆä»…ä¿ç•™ Mid ä¸€åˆ—ï¼‰</span></span><br><span class="line">encoder = OneHotEncoder(drop=<span class="string">&#x27;first&#x27;</span>, sparse_output=<span class="literal">False</span>, handle_unknown=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">encoded_train = encoder.fit_transform(X_train_sub[[<span class="string">&#x27;TenureGroup&#x27;</span>]])</span><br><span class="line">encoded_test = encoder.transform(X_test_sub[[<span class="string">&#x27;TenureGroup&#x27;</span>]])</span><br><span class="line">encoded_cols = encoder.get_feature_names_out([<span class="string">&#x27;TenureGroup&#x27;</span>])  <span class="comment"># eg. [&#x27;TenureGroup_Mid&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æ‹¼æ¥ç¼–ç ç»“æœå¹¶åˆ é™¤åŸåˆ—</span></span><br><span class="line">X_train_encoded = pd.DataFrame(encoded_train, columns=encoded_cols, index=X_train_sub.index)</span><br><span class="line">X_test_encoded = pd.DataFrame(encoded_test, columns=encoded_cols, index=X_test_sub.index)</span><br><span class="line"></span><br><span class="line">X_train_final = pd.concat([X_train_sub.drop(columns=[<span class="string">&#x27;TenureGroup&#x27;</span>]), X_train_encoded], axis=<span class="number">1</span>)</span><br><span class="line">X_test_final = pd.concat([X_test_sub.drop(columns=[<span class="string">&#x27;TenureGroup&#x27;</span>]), X_test_encoded], axis=<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… ä»…å¯¹æ•°å€¼åˆ—è¿›è¡Œæ ‡å‡†åŒ–ï¼ˆé€‚ç”¨äº Logistic Regressionï¼‰</span></span><br><span class="line">numeric_cols = [<span class="string">&#x27;tenure&#x27;</span>, <span class="string">&#x27;MonthlyCharges&#x27;</span>, <span class="string">&#x27;TotalCharges&#x27;</span>, <span class="string">&#x27;ServiceCount&#x27;</span>]</span><br><span class="line"></span><br><span class="line">scaler_final = StandardScaler()</span><br><span class="line">X_train_log_final = X_train_final.copy()</span><br><span class="line">X_test_log_final = X_test_final.copy()</span><br><span class="line"></span><br><span class="line">X_train_log_final[numeric_cols] = scaler_final.fit_transform(X_train_log_final[numeric_cols])</span><br><span class="line">X_test_log_final[numeric_cols] = scaler_final.transform(X_test_log_final[numeric_cols])</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… è®­ç»ƒæ¨¡å‹</span></span><br><span class="line">log_final_model = LogisticRegression(class_weight=<span class="string">&#x27;balanced&#x27;</span>, max_iter=<span class="number">1000</span>, random_state=<span class="number">42</span>)</span><br><span class="line">log_final_model.fit(X_train_log_final, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… é¢„æµ‹</span></span><br><span class="line">y_pred_log_final = log_final_model.predict(X_test_log_final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æŒ‡æ ‡æ±‡æ€»</span></span><br><span class="line">log_final_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Logistic Regression (Final)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_log_final),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_log_final),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_log_final),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_log_final)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… è®­ç»ƒæ¨¡å‹ï¼ˆæ— éœ€æ ‡å‡†åŒ–ï¼‰</span></span><br><span class="line">rf_final_model = RandomForestClassifier(class_weight=<span class="string">&#x27;balanced&#x27;</span>, n_estimators=<span class="number">100</span>, random_state=<span class="number">42</span>)</span><br><span class="line">rf_final_model.fit(X_train_final, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… é¢„æµ‹</span></span><br><span class="line">y_pred_rf_final = rf_final_model.predict(X_test_final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æŒ‡æ ‡æ±‡æ€»</span></span><br><span class="line">rf_final_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;Random Forest (Final)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_rf_final),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_rf_final),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_rf_final),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_rf_final)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> xgboost <span class="keyword">import</span> XGBClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, recall_score, f1_score</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… è®­ç»ƒæ¨¡å‹ï¼ˆæ— éœ€æ ‡å‡†åŒ–ï¼‰</span></span><br><span class="line">xgb_final_model = XGBClassifier(use_label_encoder=<span class="literal">False</span>, eval_metric=<span class="string">&#x27;logloss&#x27;</span>, random_state=<span class="number">42</span>)</span><br><span class="line">xgb_final_model.fit(X_train_final, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… é¢„æµ‹</span></span><br><span class="line">y_pred_xgb_final = xgb_final_model.predict(X_test_final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… æŒ‡æ ‡æ±‡æ€»</span></span><br><span class="line">xgb_final_metrics = &#123;</span><br><span class="line">    <span class="string">&#x27;Model&#x27;</span>: <span class="string">&#x27;XGBoost (Final)&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accuracy&#x27;</span>: accuracy_score(y_test, y_pred_xgb_final),</span><br><span class="line">    <span class="string">&#x27;Precision&#x27;</span>: precision_score(y_test, y_pred_xgb_final),</span><br><span class="line">    <span class="string">&#x27;Recall&#x27;</span>: recall_score(y_test, y_pred_xgb_final),</span><br><span class="line">    <span class="string">&#x27;F1-score&#x27;</span>: f1_score(y_test, y_pred_xgb_final)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-2-è¯„ä¼°"><a href="#11-2-è¯„ä¼°" class="headerlink" title="11.2 è¯„ä¼°"></a>11.2 è¯„ä¼°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¡®ä¿ä½ å·²ç»è¿è¡Œè¿‡ä»¥ä¸‹ä¸‰ä¸ªå˜é‡ï¼š</span></span><br><span class="line"><span class="comment"># log_final_metrics, rf_final_metrics, xgb_final_metrics</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‡æ€»æˆ DataFrame</span></span><br><span class="line">final_results_df = pd.DataFrame([</span><br><span class="line">    log_final_metrics,</span><br><span class="line">    rf_final_metrics,</span><br><span class="line">    xgb_final_metrics</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">display(final_results_df)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression (Final)</td>
      <td>0.718550</td>
      <td>0.482484</td>
      <td>0.810160</td>
      <td>0.604790</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest (Final)</td>
      <td>0.778962</td>
      <td>0.603960</td>
      <td>0.489305</td>
      <td>0.540620</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XGBoost (Final)</td>
      <td>0.776830</td>
      <td>0.590361</td>
      <td>0.524064</td>
      <td>0.555241</td>
    </tr>
  </tbody>
</table>
</div>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> shap</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… åˆå§‹åŒ– explainer</span></span><br><span class="line">explainer_final = shap.Explainer(xgb_final_model)</span><br><span class="line">shap_values_final = explainer_final(X_test_final)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… 1ï¸âƒ£ ç‰¹å¾é‡è¦æ€§æ¡å½¢å›¾ï¼ˆå…¨å±€ï¼‰</span></span><br><span class="line">shap.plots.bar(shap_values_final, max_display=<span class="number">15</span>, show=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># âœ… 2ï¸âƒ£ SHAP åˆ†å¸ƒå›¾ï¼ˆæ¯ä¸ªæ ·æœ¬ Ã— æ¯ä¸ªç‰¹å¾ï¼Œé¢œè‰²ä»£è¡¨ç‰¹å¾å€¼é«˜ä½ï¼‰</span></span><br><span class="line">shap.plots.beeswarm(shap_values_final, max_display=<span class="number">15</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>â€‹<br><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_136_0.png" alt="png"><br>â€‹    </p>
<p><img src="/2025/05/04/customer_churn_prediction_model/customer_churn_prediction_model.ipynb_136_1.png" alt="png"></p>
<h4 id="æœ€ç»ˆå»ºæ¨¡"><a href="#æœ€ç»ˆå»ºæ¨¡" class="headerlink" title="æœ€ç»ˆå»ºæ¨¡"></a>æœ€ç»ˆå»ºæ¨¡</h4><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>Precision</th>
      <th>Recall</th>
      <th>F1-score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logistic Regression (Final)</td>
      <td>0.718550</td>
      <td>0.482484</td>
      <td>0.810160</td>
      <td>0.604790</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Random Forest (Final)</td>
      <td>0.778962</td>
      <td>0.603960</td>
      <td>0.489305</td>
      <td>0.540620</td>
    </tr>
    <tr>
      <th>2</th>
      <td>XGBoost (Final)</td>
      <td>0.776830</td>
      <td>0.590361</td>
      <td>0.524064</td>
      <td>0.555241</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">Jin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/05/04/customer_churn_prediction_model.ipynb/">http://example.com/2025/05/04/customer_churn_prediction_model.ipynb/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">æ•°æ®åˆ†æ</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/30/House_predict/" title="æˆ¿ä»·é¢„æµ‹é¡¹ç›®æ€»ç»“"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">æˆ¿ä»·é¢„æµ‹é¡¹ç›®æ€»ç»“</div></div><div class="info-2"><div class="info-item-1">å¯¼åŒ… æè¿°æ€§ç»Ÿè®¡ æŸ¥çœ‹ç¼ºå¤±å€¼1!where python  # Windows  12345import pandas as pdtrain = pd.read_csv(&#x27;train.csv&#x27;)test = pd.read_csv(&#x27;test.csv&#x27;)   123456789# æŸ¥çœ‹æ•°æ®å½¢çŠ¶print(&quot;Train shape:&quot;, train.shape)print(&quot;Test shape:&quot;, test.shape)# æŸ¥çœ‹å‰5è¡Œtrain.head()# æŸ¥çœ‹æ•°æ®æ¦‚å†µtrain.info()  Train shape: (1460, 81) Test shape: (1459, 80) &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt; RangeIndex: 1460 entries, 0 to 1459 Data columns (total 81 columns):  #   Column         Non-Null Count...</div></div></div></a><a class="pagination-related" href="/2026/01/21/loan_approval_prediction/" title="loan approval prediction"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">loan approval prediction</div></div><div class="info-2"><div class="info-item-1">Chapter 1 | Problem Definition &amp; Business Context ç¬¬ 1 ç« ï½œé—®é¢˜å®šä¹‰ä¸ä¸šåŠ¡èƒŒæ™¯  This project addresses the problem of automated loan approval in a FinTech lending context.The objective is to build machine learning models that predict whether a loan application should be approved or rejected, based on applicantsâ€™ financial, credit, and demographic information. From a business perspective, loan approval is a risk-sensitive decision.False approvals increase default risk and capital loss, while false...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jin</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Jin-123-321"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ° Jin çš„æœºå™¨å­¦ä¹ æ—…é€”åšå®¢ âœ¨<br>ç”¨ä»£ç æ¢ç´¢ä¸–ç•Œï¼Œä»¥å›¾è¡¨ç†è§£æ•°æ®ï¼</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Telco-Customer-Churn-Prediction"><span class="toc-number">1.</span> <span class="toc-text">Telco Customer Churn Prediction</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D-%E7%9B%AE%E6%A0%87%E8%AF%B4%E6%98%8E"><span class="toc-number">1.1.</span> <span class="toc-text">1. é¡¹ç›®ä»‹ç» &amp; ç›®æ ‡è¯´æ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AF%BC%E5%85%A5%E5%BA%93-%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="toc-number">1.2.</span> <span class="toc-text">2. å¯¼å…¥åº“ &amp; åŠ è½½æ•°æ®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1. æŸ¥çœ‹æ•°æ®ç»“æ„å’Œæ•°æ®ç±»å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%A7%BC-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E9%87%8D%E7%82%B9%E6%80%BB%E7%BB%93"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">ğŸ§¼ æ•°æ®æ¸…æ´—é‡ç‚¹æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%9C%85-%E6%B8%85%E6%B4%97%E5%AE%8C%E6%88%90%E5%90%8E%E7%9A%84%E7%9B%AE%E6%A0%87%EF%BC%9A"><span class="toc-number">1.2.1.1.1.</span> <span class="toc-text">âœ… æ¸…æ´—å®Œæˆåçš„ç›®æ ‡ï¼š</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E4%B8%8E%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">1.3.</span> <span class="toc-text">3. æ•°æ®æ¸…æ´—ä¸é¢„å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 ç¼ºå¤±å€¼å¤„ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E7%89%B9%E5%BE%81%E7%BC%96%E7%A0%81"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 ç‰¹å¾ç¼–ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E7%89%B9%E5%BE%81%E7%BC%A9%E6%94%BE"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 ç‰¹å¾ç¼©æ”¾</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%8E%A2%E7%B4%A2%E6%80%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%EF%BC%88EDA%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">4. æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%9B%AE%E6%A0%87%E5%8F%98%E9%87%8F%E5%88%86%E5%B8%83%EF%BC%88Churn-%E6%A6%82%E5%86%B5%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 ç›®æ ‡å˜é‡åˆ†å¸ƒï¼ˆChurn æ¦‚å†µï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9A%96%EF%B8%8F-%E7%B1%BB%E5%88%AB%E4%B8%8D%E5%B9%B3%E8%A1%A1%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E8%AF%B4%E6%98%8E"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">âš–ï¸ ç±»åˆ«ä¸å¹³è¡¡å¤„ç†æ–¹æ³•è¯´æ˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%F0%9F%91%A8%E2%80%8D%F0%9F%91%A9%E2%80%8D%F0%9F%91%A7-%E7%B1%BB%E5%88%AB%E5%8F%98%E9%87%8F-vs-%E6%B5%81%E5%A4%B1%E7%8E%87%EF%BC%88%E5%8D%95%E5%8F%98%E9%87%8F%E5%88%86%E6%9E%90%EF%BC%89"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ç±»åˆ«å˜é‡ vs. æµå¤±ç‡ï¼ˆå•å˜é‡åˆ†æï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%F0%9F%93%89-%E6%95%B0%E5%80%BC%E5%8F%98%E9%87%8F%E5%9C%A8%E4%B8%8D%E5%90%8C%E6%B5%81%E5%A4%B1%E7%8A%B6%E6%80%81%E4%B8%8B%E7%9A%84%E5%88%86%E5%B8%83%EF%BC%88%E7%AE%B1%E7%BA%BF%E5%9B%BE%E5%88%86%E6%9E%90%EF%BC%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 ğŸ“‰ æ•°å€¼å˜é‡åœ¨ä¸åŒæµå¤±çŠ¶æ€ä¸‹çš„åˆ†å¸ƒï¼ˆç®±çº¿å›¾åˆ†æï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%9C%85-tenure%EF%BC%88%E5%9C%A8%E7%BD%91%E6%97%B6%E9%95%BF%EF%BC%89"><span class="toc-number">1.4.3.0.1.</span> <span class="toc-text">âœ… tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%9C%85-MonthlyCharges%EF%BC%88%E6%9C%88%E5%BA%A6%E6%94%B6%E8%B4%B9%EF%BC%89"><span class="toc-number">1.4.3.0.2.</span> <span class="toc-text">âœ… MonthlyChargesï¼ˆæœˆåº¦æ”¶è´¹ï¼‰</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%9C%85-TotalCharges%EF%BC%88%E6%80%BB%E8%B4%B9%E7%94%A8%EF%BC%89"><span class="toc-number">1.4.3.0.3.</span> <span class="toc-text">âœ… TotalChargesï¼ˆæ€»è´¹ç”¨ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%F0%9F%94%8D-%E5%B0%8F%E7%BB%93%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">ğŸ” å°ç»“å»ºè®®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%F0%9F%94%A5-%E7%89%B9%E5%BE%81%E7%9B%B8%E5%85%B3%E6%80%A7%E7%83%AD%E5%8A%9B%E5%9B%BE"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 ğŸ”¥ ç‰¹å¾ç›¸å…³æ€§çƒ­åŠ›å›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%9C%85-%E4%B8%8E%E7%9B%AE%E6%A0%87%E5%8F%98%E9%87%8F-Churn-%E7%9A%84%E7%9B%B8%E5%85%B3%E6%80%A7"><span class="toc-number">1.4.4.0.1.</span> <span class="toc-text">âœ… ä¸ç›®æ ‡å˜é‡ Churn çš„ç›¸å…³æ€§</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E2%9A%A0%EF%B8%8F-%E7%89%B9%E5%BE%81%E4%B9%8B%E9%97%B4%E7%9A%84%E5%BC%BA%E7%9B%B8%E5%85%B3%E6%80%A7%EF%BC%88%E6%BD%9C%E5%9C%A8%E5%86%97%E4%BD%99%EF%BC%89"><span class="toc-number">1.4.4.0.2.</span> <span class="toc-text">âš ï¸ ç‰¹å¾ä¹‹é—´çš„å¼ºç›¸å…³æ€§ï¼ˆæ½œåœ¨å†—ä½™ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E5%BB%BA%E8%AE%AE%EF%BC%88%E4%B8%BA%E5%90%8E%E7%BB%AD%E5%BB%BA%E6%A8%A1%E5%81%9A%E5%87%86%E5%A4%87%EF%BC%89"><span class="toc-number">1.4.4.1.</span> <span class="toc-text">âœ… å»ºè®®ï¼ˆä¸ºåç»­å»ºæ¨¡åšå‡†å¤‡ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%F0%9F%8E%AF-%E6%95%B0%E5%80%BC%E5%8F%98%E9%87%8F%E5%88%86%E5%B8%83%E5%9B%BE%EF%BC%88%E6%8C%89%E6%B5%81%E5%A4%B1%E6%83%85%E5%86%B5%E5%88%86%E7%BB%84%EF%BC%89"><span class="toc-number">1.4.5.</span> <span class="toc-text">4.5 ğŸ¯ æ•°å€¼å˜é‡åˆ†å¸ƒå›¾ï¼ˆæŒ‰æµå¤±æƒ…å†µåˆ†ç»„ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1%EF%B8%8F%E2%83%A3-tenure%EF%BC%88%E5%9C%A8%E7%BD%91%E6%97%B6%E9%95%BF%EF%BC%89"><span class="toc-number">1.4.5.0.1.</span> <span class="toc-text">1ï¸âƒ£ tenureï¼ˆåœ¨ç½‘æ—¶é•¿ï¼‰</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2%EF%B8%8F%E2%83%A3-MonthlyCharges%EF%BC%88%E6%9C%88%E5%BA%A6%E6%B6%88%E8%B4%B9%EF%BC%89"><span class="toc-number">1.4.5.0.2.</span> <span class="toc-text">2ï¸âƒ£ MonthlyChargesï¼ˆæœˆåº¦æ¶ˆè´¹ï¼‰</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3%EF%B8%8F%E2%83%A3-TotalCharges%EF%BC%88%E6%80%BB%E6%B6%88%E8%B4%B9%E9%87%91%E9%A2%9D%EF%BC%89"><span class="toc-number">1.4.5.0.3.</span> <span class="toc-text">3ï¸âƒ£ TotalChargesï¼ˆæ€»æ¶ˆè´¹é‡‘é¢ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E2%9C%85-%E7%BB%BC%E5%90%88%E7%BB%93%E8%AE%BA"><span class="toc-number">1.4.5.1.</span> <span class="toc-text">âœ… ç»¼åˆç»“è®º</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-%F0%9F%94%8D-%E9%AB%98%E9%98%B6%E7%BB%84%E5%90%88%E7%89%B9%E5%BE%81%E4%BA%A4%E5%8F%89%E5%88%86%E6%9E%90"><span class="toc-number">1.4.6.</span> <span class="toc-text">4.6 ğŸ” é«˜é˜¶ç»„åˆç‰¹å¾äº¤å‰åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%EF%B8%8F%E2%83%A3-Contract-PaymentMethod-%E5%AF%B9%E6%B5%81%E5%A4%B1%E7%8E%87%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-number">1.4.6.1.</span> <span class="toc-text">1ï¸âƒ£ Contract + PaymentMethod å¯¹æµå¤±ç‡çš„å½±å“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%EF%B8%8F%E2%83%A3-InternetService-OnlineSecurity-%E7%BB%84%E5%90%88%E5%88%86%E6%9E%90"><span class="toc-number">1.4.6.2.</span> <span class="toc-text">2ï¸âƒ£ InternetService + OnlineSecurity ç»„åˆåˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%EF%B8%8F%E2%83%A3-MonthlyCharges-tenure%EF%BC%88%E5%88%86%E7%AE%B1%EF%BC%89-%E7%BB%84%E5%90%88%E5%88%86%E6%9E%90"><span class="toc-number">1.4.6.3.</span> <span class="toc-text">3ï¸âƒ£ MonthlyCharges + tenureï¼ˆåˆ†ç®±ï¼‰ ç»„åˆåˆ†æ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%BB%BA%E6%A8%A1%E4%B8%8E%E8%AF%84%E4%BC%B0"><span class="toc-number">1.5.</span> <span class="toc-text">5. å»ºæ¨¡ä¸è¯„ä¼°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%BB%BA%E6%A8%A1"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 å»ºæ¨¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1%EF%BC%9ALogistic-Regression"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">5.1.1ï¼šLogistic Regression</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2%EF%BC%9ASVM"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">5.1.2ï¼šSVM</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3%EF%BC%9AKNN"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">5.1.3ï¼šKNN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-4%EF%BC%9ARandom-Forest"><span class="toc-number">1.5.1.4.</span> <span class="toc-text">5.1.4ï¼šRandom Forest</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-5%EF%BC%9AXGBoost"><span class="toc-number">1.5.1.5.</span> <span class="toc-text">5.1.5ï¼šXGBoost</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-6%EF%BC%9ANeural-Network%EF%BC%88MLP%EF%BC%89"><span class="toc-number">1.5.1.6.</span> <span class="toc-text">5.1.6ï¼šNeural Networkï¼ˆMLPï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E8%AF%84%E4%BC%B0%E6%8C%87%E6%A0%87%EF%BC%88Accuracy%E3%80%81Recall%E3%80%81F1%E3%80%81ROC%EF%BC%89"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 è¯„ä¼°æŒ‡æ ‡ï¼ˆAccuracyã€Recallã€F1ã€ROCï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90%EF%BC%88%E5%88%9D%E6%AD%A5%EF%BC%89"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">æ¨¡å‹è¯„ä¼°ç»“æœåˆ†æï¼ˆåˆæ­¥ï¼‰</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%A8%A1%E5%9E%8B%E8%A7%A3%E9%87%8A"><span class="toc-number">1.6.</span> <span class="toc-text">6. æ¨¡å‹è§£é‡Š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E6%8F%90%E5%8F%96%E7%89%B9%E5%BE%81%E9%87%8D%E8%A6%81%E6%80%A7%E6%8E%92%E5%90%8D%EF%BC%88%E6%9F%B1%E7%8A%B6%E5%9B%BE"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 æå–ç‰¹å¾é‡è¦æ€§æ’åï¼ˆæŸ±çŠ¶å›¾)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-XGBoost-%E5%86%85%E7%BD%AE%E7%89%B9%E5%BE%81%E9%87%8D%E8%A6%81%E6%80%A7%EF%BC%88Gain%EF%BC%89"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 XGBoost å†…ç½®ç‰¹å¾é‡è¦æ€§ï¼ˆGainï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E9%87%8D%E5%BB%BA%E6%A8%A1%E5%9E%8B-%E7%89%B9%E5%BE%81%E9%80%89%E5%8F%96-%E6%9E%84%E9%80%A0"><span class="toc-number">1.7.</span> <span class="toc-text">7. é‡å»ºæ¨¡å‹ ç‰¹å¾é€‰å–&#x2F;æ„é€ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E9%80%89%E5%8F%96%E9%87%8D%E8%A6%81%E7%89%B9%E5%BE%81%E9%87%8D%E5%BB%BA%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 é€‰å–é‡è¦ç‰¹å¾é‡å»ºæ¨¡å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-1-Logistic-Regression"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">7.1.1 Logistic Regression</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-Random-Forest"><span class="toc-number">1.7.1.2.</span> <span class="toc-text">7.1.2 Random Forest</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-3-XGBoost"><span class="toc-number">1.7.1.3.</span> <span class="toc-text">7.1.3 XGBoost</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-4-%E6%89%93%E5%8C%85%E8%BE%93%E5%87%BA"><span class="toc-number">1.7.1.4.</span> <span class="toc-text">7.1.4 æ‰“åŒ…è¾“å‡º</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E7%89%B9%E5%BE%81%E6%9E%84%E9%80%A0"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 ç‰¹å¾æ„é€ </span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-1-%E6%9E%84%E9%80%A0%E5%A2%9E%E5%BC%BA%E7%89%B9%E5%BE%81%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">7.3.1 æ„é€ å¢å¼ºç‰¹å¾å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-3-2-%E7%89%B9%E5%BE%81%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">1.7.2.2.</span> <span class="toc-text">7.3.2 ç‰¹å¾é¢„å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-1-Logistic-Regression%EF%BC%88%E5%9F%BA%E4%BA%8ETOP10-%E5%A2%9E%E5%BC%BA%E7%89%B9%E5%BE%81%EF%BC%89"><span class="toc-number">1.7.2.3.</span> <span class="toc-text">7.4.1 Logistic Regressionï¼ˆåŸºäºTOP10 + å¢å¼ºç‰¹å¾ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-2-Random-Forest%EF%BC%88%E5%9F%BA%E4%BA%8E-Top10-%E6%9E%84%E9%80%A0%E7%89%B9%E5%BE%81%EF%BC%89"><span class="toc-number">1.7.2.4.</span> <span class="toc-text">7.4.2 Random Forestï¼ˆåŸºäº Top10 + æ„é€ ç‰¹å¾ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-4-3-XGBoost%EF%BC%88%E5%9F%BA%E4%BA%8E-Top10-%E6%9E%84%E9%80%A0%E7%89%B9%E5%BE%81%EF%BC%89"><span class="toc-number">1.7.2.5.</span> <span class="toc-text">7.4.3 XGBoostï¼ˆåŸºäº Top10 + æ„é€ ç‰¹å¾ï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E6%B1%87%E6%80%BB"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.4 æ±‡æ€»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E4%B8%8D%E5%90%8C%E7%89%B9%E5%BE%81%E9%80%89%E5%8F%96-%E5%BB%BA%E6%A8%A1%E7%BB%93%E6%9E%9C%E5%AF%B9%E6%AF%94"><span class="toc-number">1.8.</span> <span class="toc-text">8. ä¸åŒç‰¹å¾é€‰å– å»ºæ¨¡ç»“æœå¯¹æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%A8%E7%89%B9%E5%BE%81"><span class="toc-number">1.8.0.1.</span> <span class="toc-text">å…¨ç‰¹å¾</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TOP10"><span class="toc-number">1.8.0.2.</span> <span class="toc-text">TOP10</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TOP10-%E6%9E%84%E9%80%A0%E7%89%B9%E5%BE%81"><span class="toc-number">1.8.0.3.</span> <span class="toc-text">TOP10 + æ„é€ ç‰¹å¾</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-SHAP-%E5%88%86%E6%9E%90%EF%BC%88%E5%9F%BA%E4%BA%8EXGBoost-%E9%80%89%E5%8F%96%E4%B8%8D%E5%90%8C%E7%89%B9%E5%BE%81%E8%BF%9B%E8%A1%8C%EF%BC%89"><span class="toc-number">1.9.</span> <span class="toc-text">9. SHAP åˆ†æï¼ˆåŸºäºXGBoost é€‰å–ä¸åŒç‰¹å¾è¿›è¡Œï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%85%A8%E7%89%B9%E5%BE%81"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 å…¨ç‰¹å¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-TOP10"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 TOP10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-TOP10-%E6%9E%84%E9%80%A0%E7%89%B9%E5%BE%81"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 TOP10 + æ„é€ ç‰¹å¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%8D-SHAP-%E5%88%86%E6%9E%90%E5%AF%B9%E6%AF%94%EF%BC%88%E4%B8%89%E7%BB%84%E7%89%B9%E5%BE%81%E7%89%88%E6%9C%AC%EF%BC%89"><span class="toc-number">1.9.4.</span> <span class="toc-text">ğŸ” SHAP åˆ†æå¯¹æ¯”ï¼ˆä¸‰ç»„ç‰¹å¾ç‰ˆæœ¬ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%85%A8%E7%89%B9%E5%BE%81%E7%89%88%E6%9C%AC"><span class="toc-number">1.9.4.1.</span> <span class="toc-text">1. å…¨ç‰¹å¾ç‰ˆæœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Top10-%E7%89%B9%E5%BE%81%E7%89%88%E6%9C%AC%EF%BC%88%E5%9F%BA%E4%BA%8E-SHAP-%E6%8E%92%E5%90%8D%E5%89%8D%E5%8D%81%EF%BC%89"><span class="toc-number">1.9.4.2.</span> <span class="toc-text">2. Top10 ç‰¹å¾ç‰ˆæœ¬ï¼ˆåŸºäº SHAP æ’åå‰åï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Top10-%E6%9E%84%E9%80%A0%E7%89%B9%E5%BE%81%E7%89%88%E6%9C%AC"><span class="toc-number">1.9.4.3.</span> <span class="toc-text">3. Top10 + æ„é€ ç‰¹å¾ç‰ˆæœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD"><span class="toc-number">1.9.4.4.</span> <span class="toc-text">åç»­</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%B6%88%E8%9E%8D%E5%88%86%E6%9E%90"><span class="toc-number">1.10.</span> <span class="toc-text">10. æ¶ˆèåˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E6%9C%80%E7%BB%88%E5%BB%BA%E6%A8%A1"><span class="toc-number">1.11.</span> <span class="toc-text">11 æœ€ç»ˆå»ºæ¨¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E5%BB%BA%E6%A8%A1"><span class="toc-number">1.11.1.</span> <span class="toc-text">11.1 å»ºæ¨¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-%E8%AF%84%E4%BC%B0"><span class="toc-number">1.11.2.</span> <span class="toc-text">11.2 è¯„ä¼°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E5%BB%BA%E6%A8%A1"><span class="toc-number">1.11.2.1.</span> <span class="toc-text">æœ€ç»ˆå»ºæ¨¡</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.12.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/01/21/loan_approval_prediction/" title="loan approval prediction">loan approval prediction</a><time datetime="2026-01-20T16:00:00.000Z" title="Created 2026-01-21 00:00:00">2026-01-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/04/customer_churn_prediction_model.ipynb/" title="Customer Churn Prediction Model">Customer Churn Prediction Model</a><time datetime="2025-05-04T13:00:00.000Z" title="Created 2025-05-04 21:00:00">2025-05-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/30/House_predict/" title="æˆ¿ä»·é¢„æµ‹é¡¹ç›®æ€»ç»“">æˆ¿ä»·é¢„æµ‹é¡¹ç›®æ€»ç»“</a><time datetime="2025-03-29T16:00:00.000Z" title="Created 2025-03-30 00:00:00">2025-03-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/28/titanic_analysis/" title="æ³°å¦å°¼å…‹å·é¡¹ç›®æ€»ç»“">æ³°å¦å°¼å…‹å·é¡¹ç›®æ€»ç»“</a><time datetime="2025-03-27T16:00:00.000Z" title="Created 2025-03-28 00:00:00">2025-03-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2026 By Jin</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>